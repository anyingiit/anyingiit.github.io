<!DOCTYPE html><html class="2xl:text-[20px]" dir="ltr" lang="en"><head><meta charset="UTF-8"><meta content="width=device-width,initial-scale=1" name="viewport"><link href="/sitemap-index.xml" rel="sitemap"><link href="/_astro/favicon.CGiRCjPI.ico" rel="shortcut icon"><link href="/_astro/favicon.vp_fBu0c.svg" rel="icon" type="image/svg+xml"><link href="/_astro/favicon.vp_fBu0c.svg" rel="mask-icon" color="#8D46E7"><link href="/_astro/apple-touch-icon.DHIlG7dp.png" rel="apple-touch-icon" sizes="180x180"><style>:root{--aw-font-sans:'Inter Variable';--aw-font-serif:'Inter Variable';--aw-font-heading:'Inter Variable';--aw-color-primary:rgb(1 97 239);--aw-color-secondary:rgb(1 84 207);--aw-color-accent:rgb(109 40 217);--aw-color-text-heading:rgb(0 0 0);--aw-color-text-default:rgb(16 16 16);--aw-color-text-muted:rgb(16 16 16 / 66%);--aw-color-bg-page:rgb(255 255 255);--aw-color-bg-page-dark:rgb(3 6 32)}.dark{--aw-font-sans:'Inter Variable';--aw-font-serif:'Inter Variable';--aw-font-heading:'Inter Variable';--aw-color-primary:rgb(1 97 239);--aw-color-secondary:rgb(1 84 207);--aw-color-accent:rgb(109 40 217);--aw-color-text-heading:rgb(247, 248, 248);--aw-color-text-default:rgb(229 236 246);--aw-color-text-muted:rgb(229 236 246 / 66%);--aw-color-bg-page:rgb(3 6 32)}</style><script>!function(){const e="system";function t(e){"dark"===e?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark");const t=document.querySelectorAll("[data-aw-toggle-color-scheme] > input");t&&t.length&&t.forEach((t=>{t.checked="dark"!==e}))}e&&e.endsWith(":only")||(localStorage.theme,0)?t(e.replace(":only","")):"dark"===localStorage.theme||!("theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):t("light")}()</script><title>Jpos-glue â€” AstroWind</title><meta content="ðŸš€ Suitable for Startups, Small Business, Sass Websites, Professional Portfolios, Marketing Websites, Landing Pages &amp; Blogs." name="description"><meta content="index,follow" name="robots"><link href="https://astrowind.vercel.app/ja/2025-06-23-pos-sample" rel="canonical"><meta content="Jpos-glue" property="og:title"><meta content="ðŸš€ Suitable for Startups, Small Business, Sass Websites, Professional Portfolios, Marketing Websites, Landing Pages &amp; Blogs." property="og:description"><meta content="https://astrowind.vercel.app/ja/2025-06-23-pos-sample" property="og:url"><meta content="article" property="og:type"><meta content="https://astrowind.vercel.app/_astro/default.CZ816Hke_2bosb5.jpg" property="og:image"><meta content="1200" property="og:image:width"><meta content="628" property="og:image:height"><meta content="en" property="og:locale"><meta content="AstroWind" property="og:site_name"><meta content="summary_large_image" name="twitter:card"><meta content="@onwidget" name="twitter:site"><meta content="@onwidget" name="twitter:creator"><meta content="orcPxI47GSa-cRvY11tUe6iGg2IO_RPvnA1q95iEM3M" name="google-site-verification"><meta content="true" name="astro-view-transitions-enabled"><meta content="swap" name="astro-view-transitions-fallback"><script type="module" src="/_astro/ClientRouter.astro_astro_type_script_index_0_lang.BZs-2RF_.js"></script><link href="/_astro/click-through.CrMTA7gW.css" rel="stylesheet"></head><body class="antialiased bg-page text-default tracking-tight"><div class="text-muted text-sm gap-1 bg-black dark dark:bg-transparent dark:border-b dark:border-slate-800 dark:text-slate-400 hidden md:flex overflow-hidden px-3 py-2 relative text-ellipsis whitespace-nowrap"><span class="inline-block dark:bg-slate-700 py-0.5 rtl:mr-0 bg-white/40 dark:text-slate-300 font-semibold mr-0.5 px-1 rtl:ml-0.5 text-xs">NEW</span> <a class="text-muted hover:underline dark:text-slate-400 font-medium" href="https://astro.build/blog/astro-570/">Astro v5.7 is now available! Â»</a> <a class="inline-block bg-[url(https://img.shields.io/github/stars/onwidget/astrowind.svg?style=social&label=Stars&maxAge=86400)] bg-contain h-[1.25rem] ltr:ml-auto ml-auto rtl:mr-auto w-[5.6rem]" href="https://github.com/onwidget/astrowind" rel="noopener" target="_blank" title="If you like AstroWind, give us a star."></a></div><header class="mx-auto w-full border-b border-gray-50/0 ease-in-out flex-none sticky top-0 transition-[opacity] z-40" data-aw-sticky-header="true" id="header"><div class="absolute inset-0"></div><div class="mx-auto w-full max-w-7xl md:grid md:grid-cols-3 md:items-center md:px-6 px-3 py-3 relative text-default"><div class="flex justify-between"><a class="items-center flex" href="/"><span class="rtl:ml-0 ml-2 rtl:mr-2 dark:text-white font-bold md:text-xl self-center text-2xl text-gray-900 whitespace-nowrap">ðŸš€ AstroWind</span></a><div class="items-center flex md:hidden"><button class="items-center flex cursor-pointer flex-col group h-12 justify-center rounded w-12" type="button" aria-label="Toggle Menu" data-aw-toggle-menu><span class="sr-only">Toggle Menu</span> <span class="transition duration-200 bg-black dark:bg-white ease h-0.5 my-1 opacity-80 rounded-full transform w-6 group-[.expanded]:rotate-45 group-[.expanded]:translate-y-2.5" aria-hidden="true"></span> <span class="transition duration-200 bg-black dark:bg-white ease h-0.5 my-1 opacity-80 rounded-full transform w-6 group-[.expanded]:opacity-0" aria-hidden="true"></span> <span class="transition duration-200 bg-black dark:bg-white ease h-0.5 my-1 opacity-80 rounded-full transform w-6 group-[.expanded]:-rotate-45 group-[.expanded]:-translate-y-2.5" aria-hidden="true"></span></button></div></div><nav aria-label="Main navigation" class="items-center md:w-auto w-full hidden md:flex md:justify-self-center md:mx-5 md:overflow-x-auto md:overflow-y-visible overflow-x-hidden overflow-y-auto text-default"><ul class="font-medium flex-col flex md:flex-row md:justify-center md:self-center md:text-[0.9375rem] md:w-auto text-xl tracking-[0.01rem] w-full"><li class="dropdown"><button class="dark:hover:text-white hover:text-link flex items-center px-4 py-3 whitespace-nowrap" type="button">Homes <svg class="rtl:ml-0 h-3.5 hidden md:inline ml-0.5 rtl:mr-0.5 w-3.5" data-icon="tabler:chevron-down" height="1em" width="1em"><symbol id="ai:tabler:chevron-down" viewBox="0 0 24 24"><path d="m6 9l6 6l6-6" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/></symbol><use href="#ai:tabler:chevron-down"></use></svg></button><ul class="font-medium dark:md:bg-dark drop-shadow-xl dropdown-menu md:absolute md:backdrop-blur-md md:bg-white/90 md:hidden md:min-w-[200px] md:pl-0 pl-4 rounded"><li><a class="dark:hover:bg-gray-700 block py-2 dark:hover:text-white first:rounded-t hover:text-link last:rounded-b md:hover:bg-gray-100 px-5 whitespace-no-wrap" href="/homes/saas">SaaS</a></li><li><a class="dark:hover:bg-gray-700 block py-2 dark:hover:text-white first:rounded-t hover:text-link last:rounded-b md:hover:bg-gray-100 px-5 whitespace-no-wrap" href="/homes/startup">Startup</a></li><li><a class="dark:hover:bg-gray-700 block py-2 dark:hover:text-white first:rounded-t hover:text-link last:rounded-b md:hover:bg-gray-100 px-5 whitespace-no-wrap" href="/homes/mobile-app">Mobile App</a></li><li><a class="dark:hover:bg-gray-700 block py-2 dark:hover:text-white first:rounded-t hover:text-link last:rounded-b md:hover:bg-gray-100 px-5 whitespace-no-wrap" href="/homes/personal">Personal</a></li></ul></li><li class="dropdown"><button class="dark:hover:text-white hover:text-link flex items-center px-4 py-3 whitespace-nowrap" type="button">Pages <svg class="rtl:ml-0 h-3.5 hidden md:inline ml-0.5 rtl:mr-0.5 w-3.5" data-icon="tabler:chevron-down" height="1em" width="1em" viewBox="0 0 24 24"><use href="#ai:tabler:chevron-down"></use></svg></button><ul class="font-medium dark:md:bg-dark drop-shadow-xl dropdown-menu md:absolute md:backdrop-blur-md md:bg-white/90 md:hidden md:min-w-[200px] md:pl-0 pl-4 rounded"><li><a class="dark:hover:bg-gray-700 block py-2 dark:hover:text-white first:rounded-t hover:text-link last:rounded-b md:hover:bg-gray-100 px-5 whitespace-no-wrap" href="/#features">Features (Anchor Link)</a></li><li><a class="dark:hover:bg-gray-700 block py-2 dark:hover:text-white first:rounded-t hover:text-link last:rounded-b md:hover:bg-gray-100 px-5 whitespace-no-wrap" href="/services">Services</a></li><li><a class="dark:hover:bg-gray-700 block py-2 dark:hover:text-white first:rounded-t hover:text-link last:rounded-b md:hover:bg-gray-100 px-5 whitespace-no-wrap" href="/pricing">Pricing</a></li><li><a class="dark:hover:bg-gray-700 block py-2 dark:hover:text-white first:rounded-t hover:text-link last:rounded-b md:hover:bg-gray-100 px-5 whitespace-no-wrap" href="/about">About us</a></li><li><a class="dark:hover:bg-gray-700 block py-2 dark:hover:text-white first:rounded-t hover:text-link last:rounded-b md:hover:bg-gray-100 px-5 whitespace-no-wrap" href="/contact">Contact</a></li><li><a class="dark:hover:bg-gray-700 block py-2 dark:hover:text-white first:rounded-t hover:text-link last:rounded-b md:hover:bg-gray-100 px-5 whitespace-no-wrap" href="/terms">Terms</a></li><li><a class="dark:hover:bg-gray-700 block py-2 dark:hover:text-white first:rounded-t hover:text-link last:rounded-b md:hover:bg-gray-100 px-5 whitespace-no-wrap" href="/privacy">Privacy policy</a></li></ul></li><li class="dropdown"><button class="dark:hover:text-white hover:text-link flex items-center px-4 py-3 whitespace-nowrap" type="button">Landing <svg class="rtl:ml-0 h-3.5 hidden md:inline ml-0.5 rtl:mr-0.5 w-3.5" data-icon="tabler:chevron-down" height="1em" width="1em" viewBox="0 0 24 24"><use href="#ai:tabler:chevron-down"></use></svg></button><ul class="font-medium dark:md:bg-dark drop-shadow-xl dropdown-menu md:absolute md:backdrop-blur-md md:bg-white/90 md:hidden md:min-w-[200px] md:pl-0 pl-4 rounded"><li><a class="dark:hover:bg-gray-700 block py-2 dark:hover:text-white first:rounded-t hover:text-link last:rounded-b md:hover:bg-gray-100 px-5 whitespace-no-wrap" href="/landing/lead-generation">Lead Generation</a></li><li><a class="dark:hover:bg-gray-700 block py-2 dark:hover:text-white first:rounded-t hover:text-link last:rounded-b md:hover:bg-gray-100 px-5 whitespace-no-wrap" href="/landing/sales">Long-form Sales</a></li><li><a class="dark:hover:bg-gray-700 block py-2 dark:hover:text-white first:rounded-t hover:text-link last:rounded-b md:hover:bg-gray-100 px-5 whitespace-no-wrap" href="/landing/click-through">Click-Through</a></li><li><a class="dark:hover:bg-gray-700 block py-2 dark:hover:text-white first:rounded-t hover:text-link last:rounded-b md:hover:bg-gray-100 px-5 whitespace-no-wrap" href="/landing/product">Product Details (or Services)</a></li><li><a class="dark:hover:bg-gray-700 block py-2 dark:hover:text-white first:rounded-t hover:text-link last:rounded-b md:hover:bg-gray-100 px-5 whitespace-no-wrap" href="/landing/pre-launch">Coming Soon or Pre-Launch</a></li><li><a class="dark:hover:bg-gray-700 block py-2 dark:hover:text-white first:rounded-t hover:text-link last:rounded-b md:hover:bg-gray-100 px-5 whitespace-no-wrap" href="/landing/subscription">Subscription</a></li></ul></li><li class="dropdown"><button class="dark:hover:text-white hover:text-link flex items-center px-4 py-3 whitespace-nowrap" type="button">Blog <svg class="rtl:ml-0 h-3.5 hidden md:inline ml-0.5 rtl:mr-0.5 w-3.5" data-icon="tabler:chevron-down" height="1em" width="1em" viewBox="0 0 24 24"><use href="#ai:tabler:chevron-down"></use></svg></button><ul class="font-medium dark:md:bg-dark drop-shadow-xl dropdown-menu md:absolute md:backdrop-blur-md md:bg-white/90 md:hidden md:min-w-[200px] md:pl-0 pl-4 rounded"><li><a class="dark:hover:bg-gray-700 block py-2 dark:hover:text-white first:rounded-t hover:text-link last:rounded-b md:hover:bg-gray-100 px-5 whitespace-no-wrap" href="/blog">Blog List</a></li><li><a class="dark:hover:bg-gray-700 block py-2 dark:hover:text-white first:rounded-t hover:text-link last:rounded-b md:hover:bg-gray-100 px-5 whitespace-no-wrap" href="/get-started-website-with-astro-tailwind-css">Article</a></li><li><a class="dark:hover:bg-gray-700 block py-2 dark:hover:text-white first:rounded-t hover:text-link last:rounded-b md:hover:bg-gray-100 px-5 whitespace-no-wrap" href="/markdown-elements-demo-post">Article (with MDX)</a></li><li><a class="dark:hover:bg-gray-700 block py-2 dark:hover:text-white first:rounded-t hover:text-link last:rounded-b md:hover:bg-gray-100 px-5 whitespace-no-wrap" href="/category/tutorials">Category Page</a></li><li><a class="dark:hover:bg-gray-700 block py-2 dark:hover:text-white first:rounded-t hover:text-link last:rounded-b md:hover:bg-gray-100 px-5 whitespace-no-wrap" href="/tag/astro">Tag Page</a></li></ul></li><li class><a class="dark:hover:text-white hover:text-link flex items-center px-4 py-3 whitespace-nowrap" href="#">Widgets</a></li></ul></nav><div class="items-center md:w-auto w-full hidden md:flex bottom-0 fixed justify-end left-0 md:justify-self-end md:mb-0 md:p-0 md:self-center md:static p-3 rtl:left-auto rtl:right-0"><div class="items-center flex justify-between md:w-auto w-full"><div class="items-center flex"><language-selector class="relative language-selector"><button class="dark:hover:text-white py-2 dark:text-gray-300 duration-200 flex font-medium hover:text-primary items-center px-3 text-gray-700 text-sm transition-colors" type="button" data-dropdown-toggle="language-dropdown"><svg class="h-4 w-4 mr-1" data-icon="tabler:world" height="1em" width="1em"><symbol id="ai:tabler:world" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M3 12a9 9 0 1 0 18 0a9 9 0 0 0-18 0m.6-3h16.8M3.6 15h16.8"/><path d="M11.5 3a17 17 0 0 0 0 18m1-18a17 17 0 0 1 0 18"/></g></symbol><use href="#ai:tabler:world"></use></svg> <span>ä¸­æ–‡</span> <svg class="h-3 ml-1 w-3" data-icon="tabler:chevron-down" height="1em" width="1em" viewBox="0 0 24 24"><use href="#ai:tabler:chevron-down"></use></svg></button><div class="absolute bg-white border border-gray-200 dark:bg-gray-800 dark:border-gray-700 hidden mt-2 right-0 rounded-md shadow-lg w-32 z-50" id="language-dropdown"><a class="dark:hover:bg-gray-700 block py-2 duration-200 hover:bg-gray-100 px-4 text-sm transition-colors dark:text-blue-400 font-medium text-primary" href="/2025-06-23-pos-sample">ä¸­æ–‡ </a><a class="dark:hover:bg-gray-700 block py-2 duration-200 hover:bg-gray-100 px-4 text-sm transition-colors dark:text-gray-300 text-gray-700" href="/en/2025-06-23-pos-sample">English </a><a class="dark:hover:bg-gray-700 block py-2 duration-200 hover:bg-gray-100 px-4 text-sm transition-colors dark:text-gray-300 text-gray-700" href="/ja/2025-06-23-pos-sample">æ—¥æœ¬èªž</a></div></language-selector><script type="module">class o extends HTMLElement{connectedCallback(){const e=this.querySelector('[data-dropdown-toggle="language-dropdown"]'),t=this.querySelector("#language-dropdown");e&&t&&(e.addEventListener("click",(e=>{e.stopPropagation(),t.classList.toggle("hidden")})),document.addEventListener("click",(()=>{t.classList.add("hidden")})),t.addEventListener("click",(e=>{e.stopPropagation()})))}}customElements.define("language-selector",o)</script><button class="text-muted dark:text-gray-400 dark:focus:ring-gray-700 dark:hover:bg-gray-700 focus:outline-none focus:ring-4 focus:ring-gray-200 hover:bg-gray-100 inline-flex items-center p-2.5 rounded-lg text-sm" type="button" aria-label="Toggle between Dark and Light mode" data-aw-toggle-color-scheme><svg class="w-6 h-6 md:h-5 md:inline-block md:w-5 ml-2" data-icon="tabler:sun" height="1em" width="1em"><symbol id="ai:tabler:sun" viewBox="0 0 24 24"><path d="M8 12a4 4 0 1 0 8 0a4 4 0 1 0-8 0m-5 0h1m8-9v1m8 8h1m-9 8v1M5.6 5.6l.7.7m12.1-.7l-.7.7m0 11.4l.7.7m-12.1-.7l-.7.7" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/></symbol><use href="#ai:tabler:sun"></use></svg></button> <a class="text-muted dark:text-gray-400 dark:focus:ring-gray-700 dark:hover:bg-gray-700 focus:outline-none focus:ring-4 focus:ring-gray-200 hover:bg-gray-100 inline-flex items-center p-2.5 rounded-lg text-sm ml-2" href="/rss.xml" aria-label="RSS Feed"><svg class="h-5 w-5" data-icon="tabler:rss" height="1em" width="1em"><symbol id="ai:tabler:rss" viewBox="0 0 24 24"><path d="M4 19a1 1 0 1 0 2 0a1 1 0 1 0-2 0M4 4a16 16 0 0 1 16 16M4 11a9 9 0 0 1 9 9" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/></symbol><use href="#ai:tabler:rss"></use></svg></a></div><span class="rtl:ml-0 ml-4 rtl:mr-4"><a class="font-semibold text-sm btn-secondary md:px-6 ml-2 px-5.5 py-2.5 shadow-none w-auto" href="https://github.com/onwidget/astrowind" rel="noopener noreferrer" target="_blank">Download</a></span></div></div></div></header><main><section class="mx-auto lg:py-20 py-8 sm:py-16"><article><header class="intersect-once intersect-quarter motion-safe:md:opacity-0 motion-safe:md:intersect:animate-fade"><div class="mb-2 flex flex-col justify-between max-w-3xl mt-0 mx-auto px-4 sm:flex-row sm:items-center sm:px-6"><p><svg class="inline-block -mt-0.5 dark:text-gray-400 h-4 w-4" data-icon="tabler:clock" height="1em" width="1em"><symbol id="ai:tabler:clock" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M3 12a9 9 0 1 0 18 0a9 9 0 0 0-18 0"/><path d="M12 7v5l3 3"/></g></symbol><use href="#ai:tabler:clock"></use></svg> <time class="inline-block" datetime="Mon Jun 23 2025 00:00:00 GMT+0000 (Coordinated Universal Time)">Jun 23, 2025</time> &nbsp;Â· <span>5</span> min read</p></div><h1 class="mx-auto sm:px-6 max-w-3xl px-4 font-bold font-heading leading-tighter md:text-5xl text-4xl tracking-tighter">Jpos-glue</h1><p class="text-muted dark:text-slate-400 max-w-3xl mb-8 md:text-2xl mt-4 mx-auto px-4 sm:px-6 text-justify text-xl"></p><div class="mx-auto sm:px-6 max-w-3xl px-4"><div class="border-t dark:border-slate-700"></div></div></header><div class="mx-auto sm:px-6 max-w-3xl px-4"><div class="dark:bg-gray-800 bg-gray-50 mb-6 p-4 rounded-lg translation-status"><div class="items-center flex mb-3"><svg class="h-5 w-5 dark:text-blue-400 mr-2 text-blue-600" data-icon="tabler:language" height="1em" width="1em"><symbol id="ai:tabler:language" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M4 5h7M9 3v2c0 4.418-2.239 8-5 8"/><path d="M5 9c0 2.144 2.952 3.908 6.7 4m.3 7l4-9l4 9m-.9-2h-6.2"/></g></symbol><use href="#ai:tabler:language"></use></svg><h3 class="font-semibold text-sm dark:text-white text-gray-900">å¤šè¯­è¨€ç‰ˆæœ¬ / Multi-language Versions</h3></div><div class="flex-wrap flex gap-2"><a class="items-center inline-flex bg-blue-100 dark:bg-blue-900 dark:text-blue-200 duration-200 font-medium px-3 py-1 rounded-full text-blue-800 text-xs transition-colors" href="en/2025-06-23-pos-sample">ä¸­æ–‡<svg class="h-3 ml-1 w-3" data-icon="tabler:check" height="1em" width="1em"><symbol id="ai:tabler:check" viewBox="0 0 24 24"><path d="m5 12l5 5L20 7" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/></symbol><use href="#ai:tabler:check"></use></svg></a><a class="items-center inline-flex bg-blue-100 dark:bg-blue-900 dark:text-blue-200 duration-200 font-medium px-3 py-1 rounded-full text-blue-800 text-xs transition-colors" href="ja/2025-06-23-pos-sample">ä¸­æ–‡<svg class="h-3 ml-1 w-3" data-icon="tabler:check" height="1em" width="1em" viewBox="0 0 24 24"><use href="#ai:tabler:check"></use></svg></a></div></div></div><div class="mx-auto sm:px-6 max-w-3xl px-6 mt-8 dark:prose-a:text-blue-400 dark:prose-headings:text-slate-300 dark:prose-invert lg:prose-xl prose prose-a:text-primary prose-headings:font-bold prose-headings:font-heading prose-headings:leading-tighter prose-headings:scroll-mt-[80px] prose-headings:tracking-tighter prose-img:rounded-md prose-img:shadow-lg prose-li:my-0 prose-md"><pre class="astro-code github-dark" data-language="java" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0"><code><span class="line"><span style="color:#e1e4e8">find . </span><span style="color:#f97583">-</span><span style="color:#e1e4e8">type f </span><span style="color:#f97583">|</span><span style="color:#f97583"> while</span><span style="color:#e1e4e8"> read </span><span style="color:#f97583">-</span><span style="color:#e1e4e8">r file; </span><span style="color:#f97583">do</span></span>
<span class="line"><span style="color:#e1e4e8">  echo </span><span style="color:#9ecbff">"===== $file ====="</span></span>
<span class="line"><span style="color:#e1e4e8">  cat </span><span style="color:#9ecbff">"$file"</span></span>
<span class="line"><span style="color:#e1e4e8">  echo</span></span>
<span class="line"><span style="color:#e1e4e8">done</span></span>
<span class="line"><span style="color:#f97583">=====</span><span style="color:#e1e4e8"> .</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">comm</span><span style="color:#f97583">-</span><span style="color:#e1e4e8">adapters</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">serial</span><span style="color:#f97583">-</span><span style="color:#e1e4e8">bridge</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">pom.xml </span><span style="color:#f97583">=====</span></span>
<span class="line"><span style="color:#f97583">&#x3C;</span><span style="color:#e1e4e8">project xmlns</span><span style="color:#f97583">=</span><span style="color:#9ecbff">"http://maven.apache.org/POM/4.0.0"</span></span>
<span class="line"><span style="color:#e1e4e8">         xmlns</span><span style="color:#f97583">:</span><span style="color:#e1e4e8">xsi</span><span style="color:#f97583">=</span><span style="color:#9ecbff">"http://www.w3.org/2001/XMLSchema-instance"</span></span>
<span class="line"><span style="color:#e1e4e8">         xsi</span><span style="color:#f97583">:</span><span style="color:#e1e4e8">schemaLocation</span><span style="color:#f97583">=</span><span style="color:#9ecbff">"http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd"</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">  &#x3C;</span><span style="color:#e1e4e8">modelVersion</span><span style="color:#f97583">></span><span style="color:#79b8ff">4.0</span><span style="color:#e1e4e8">.</span><span style="color:#fdaeb7;font-style:italic">0</span><span style="color:#f97583">&#x3C;/</span><span style="color:#e1e4e8">modelVersion</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">  &#x3C;</span><span style="color:#e1e4e8">parent</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">    &#x3C;</span><span style="color:#e1e4e8">groupId</span><span style="color:#f97583">></span><span style="color:#e1e4e8">com.example</span><span style="color:#f97583">&#x3C;/</span><span style="color:#e1e4e8">groupId</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">    &#x3C;</span><span style="color:#e1e4e8">artifactId</span><span style="color:#f97583">></span><span style="color:#e1e4e8">pos</span><span style="color:#f97583">-</span><span style="color:#e1e4e8">solution</span><span style="color:#f97583">&#x3C;/</span><span style="color:#e1e4e8">artifactId</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">    &#x3C;</span><span style="color:#e1e4e8">version</span><span style="color:#f97583">></span><span style="color:#79b8ff">1.0</span><span style="color:#f97583">-</span><span style="color:#e1e4e8">SNAPSHOT</span><span style="color:#f97583">&#x3C;/</span><span style="color:#e1e4e8">version</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">  &#x3C;/</span><span style="color:#e1e4e8">parent</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">  &#x3C;</span><span style="color:#e1e4e8">artifactId</span><span style="color:#f97583">></span><span style="color:#e1e4e8">serial</span><span style="color:#f97583">-</span><span style="color:#e1e4e8">bridge</span><span style="color:#f97583">&#x3C;/</span><span style="color:#e1e4e8">artifactId</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">  &#x3C;</span><span style="color:#e1e4e8">dependencies</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">    &#x3C;</span><span style="color:#e1e4e8">dependency</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">      &#x3C;</span><span style="color:#e1e4e8">groupId</span><span style="color:#f97583">></span><span style="color:#e1e4e8">com.fazecast</span><span style="color:#f97583">&#x3C;/</span><span style="color:#e1e4e8">groupId</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">      &#x3C;</span><span style="color:#e1e4e8">artifactId</span><span style="color:#f97583">></span><span style="color:#e1e4e8">jSerialComm</span><span style="color:#f97583">&#x3C;/</span><span style="color:#e1e4e8">artifactId</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">      &#x3C;</span><span style="color:#e1e4e8">version</span><span style="color:#f97583">></span><span style="color:#79b8ff">2.10</span><span style="color:#e1e4e8">.</span><span style="color:#fdaeb7;font-style:italic">4</span><span style="color:#f97583">&#x3C;/</span><span style="color:#e1e4e8">version</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">    &#x3C;/</span><span style="color:#e1e4e8">dependency</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">  &#x3C;/</span><span style="color:#e1e4e8">dependencies</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">&#x3C;/</span><span style="color:#e1e4e8">project</span><span style="color:#f97583">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">=====</span><span style="color:#e1e4e8"> .</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">comm</span><span style="color:#f97583">-</span><span style="color:#e1e4e8">adapters</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">serial</span><span style="color:#f97583">-</span><span style="color:#e1e4e8">bridge</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">src</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">main</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">java</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">com</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">example</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">bridge</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">SerialBridge.java </span><span style="color:#f97583">=====</span></span>
<span class="line"><span style="color:#f97583">package</span><span style="color:#e1e4e8"> com.example.bridge;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">import</span><span style="color:#e1e4e8"> com.fazecast.jSerialComm.SerialPort;</span></span>
<span class="line"><span style="color:#f97583">import</span><span style="color:#e1e4e8"> java.io.IOException;</span></span>
<span class="line"><span style="color:#f97583">import</span><span style="color:#e1e4e8"> java.time.Duration;</span></span>
<span class="line"><span style="color:#f97583">import</span><span style="color:#e1e4e8"> java.util.function.Predicate;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">public</span><span style="color:#f97583"> class</span><span style="color:#b392f0"> SerialBridge</span><span style="color:#e1e4e8"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">    private</span><span style="color:#e1e4e8"> SerialPort port;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">    public</span><span style="color:#b392f0"> SerialBridge</span><span style="color:#e1e4e8">(String </span><span style="color:#ffab70">portName</span><span style="color:#e1e4e8">) {</span></span>
<span class="line"><span style="color:#e1e4e8">        port </span><span style="color:#f97583">=</span><span style="color:#e1e4e8"> SerialPort.</span><span style="color:#b392f0">getCommPort</span><span style="color:#e1e4e8">(portName);</span></span>
<span class="line"><span style="color:#e1e4e8">        port.</span><span style="color:#b392f0">setBaudRate</span><span style="color:#e1e4e8">(</span><span style="color:#79b8ff">9600</span><span style="color:#e1e4e8">);</span></span>
<span class="line"><span style="color:#e1e4e8">        port.</span><span style="color:#b392f0">openPort</span><span style="color:#e1e4e8">();</span></span>
<span class="line"><span style="color:#e1e4e8">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">    public</span><span style="color:#f97583"> synchronized</span><span style="color:#f97583"> void</span><span style="color:#b392f0"> write</span><span style="color:#e1e4e8">(</span><span style="color:#f97583">byte</span><span style="color:#e1e4e8">[] </span><span style="color:#ffab70">data</span><span style="color:#e1e4e8">) </span><span style="color:#f97583">throws</span><span style="color:#e1e4e8"> IOException {</span></span>
<span class="line"><span style="color:#e1e4e8">        port.</span><span style="color:#b392f0">getOutputStream</span><span style="color:#e1e4e8">().</span><span style="color:#b392f0">write</span><span style="color:#e1e4e8">(data);</span></span>
<span class="line"><span style="color:#e1e4e8">        port.</span><span style="color:#b392f0">getOutputStream</span><span style="color:#e1e4e8">().</span><span style="color:#b392f0">flush</span><span style="color:#e1e4e8">();</span></span>
<span class="line"><span style="color:#e1e4e8">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">    public</span><span style="color:#f97583"> void</span><span style="color:#b392f0"> expectAck</span><span style="color:#e1e4e8">(Duration </span><span style="color:#ffab70">timeout</span><span style="color:#e1e4e8">) </span><span style="color:#f97583">throws</span><span style="color:#e1e4e8"> IOException {</span></span>
<span class="line"><span style="color:#f97583">        long</span><span style="color:#e1e4e8"> limit </span><span style="color:#f97583">=</span><span style="color:#e1e4e8"> System.</span><span style="color:#b392f0">currentTimeMillis</span><span style="color:#e1e4e8">() </span><span style="color:#f97583">+</span><span style="color:#e1e4e8"> timeout.</span><span style="color:#b392f0">toMillis</span><span style="color:#e1e4e8">();</span></span>
<span class="line"><span style="color:#f97583">        while</span><span style="color:#e1e4e8"> (System.</span><span style="color:#b392f0">currentTimeMillis</span><span style="color:#e1e4e8">() </span><span style="color:#f97583">&#x3C;</span><span style="color:#e1e4e8"> limit) {</span></span>
<span class="line"><span style="color:#f97583">            if</span><span style="color:#e1e4e8"> (port.</span><span style="color:#b392f0">bytesAvailable</span><span style="color:#e1e4e8">() </span><span style="color:#f97583">></span><span style="color:#79b8ff"> 0</span><span style="color:#e1e4e8">) {</span></span>
<span class="line"><span style="color:#f97583">                int</span><span style="color:#e1e4e8"> b </span><span style="color:#f97583">=</span><span style="color:#e1e4e8"> port.</span><span style="color:#b392f0">getInputStream</span><span style="color:#e1e4e8">().</span><span style="color:#b392f0">read</span><span style="color:#e1e4e8">();</span></span>
<span class="line"><span style="color:#f97583">                if</span><span style="color:#e1e4e8"> (b </span><span style="color:#f97583">==</span><span style="color:#79b8ff"> 0x06</span><span style="color:#e1e4e8">) </span><span style="color:#f97583">return</span><span style="color:#e1e4e8">; </span><span style="color:#6a737d">// ACK</span></span>
<span class="line"><span style="color:#e1e4e8">            }</span></span>
<span class="line"><span style="color:#e1e4e8">        }</span></span>
<span class="line"><span style="color:#f97583">        throw</span><span style="color:#f97583"> new</span><span style="color:#b392f0"> IOException</span><span style="color:#e1e4e8">(</span><span style="color:#9ecbff">"ACK timeout"</span><span style="color:#e1e4e8">);</span></span>
<span class="line"><span style="color:#e1e4e8">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">    public</span><span style="color:#f97583"> byte</span><span style="color:#e1e4e8">[] </span><span style="color:#b392f0">readResponse</span><span style="color:#e1e4e8">(Duration </span><span style="color:#ffab70">timeout</span><span style="color:#e1e4e8">, Predicate&#x3C;</span><span style="color:#f97583">byte</span><span style="color:#e1e4e8">[]> </span><span style="color:#ffab70">term</span><span style="color:#e1e4e8">) </span><span style="color:#f97583">throws</span><span style="color:#e1e4e8"> IOException {</span></span>
<span class="line"><span style="color:#f97583">        long</span><span style="color:#e1e4e8"> limit </span><span style="color:#f97583">=</span><span style="color:#e1e4e8"> System.</span><span style="color:#b392f0">currentTimeMillis</span><span style="color:#e1e4e8">() </span><span style="color:#f97583">+</span><span style="color:#e1e4e8"> timeout.</span><span style="color:#b392f0">toMillis</span><span style="color:#e1e4e8">();</span></span>
<span class="line"><span style="color:#e1e4e8">        java.io.ByteArrayOutputStream buf </span><span style="color:#f97583">=</span><span style="color:#f97583"> new</span><span style="color:#e1e4e8"> java.io.</span><span style="color:#b392f0">ByteArrayOutputStream</span><span style="color:#e1e4e8">();</span></span>
<span class="line"><span style="color:#f97583">        while</span><span style="color:#e1e4e8"> (System.</span><span style="color:#b392f0">currentTimeMillis</span><span style="color:#e1e4e8">() </span><span style="color:#f97583">&#x3C;</span><span style="color:#e1e4e8"> limit) {</span></span>
<span class="line"><span style="color:#f97583">            while</span><span style="color:#e1e4e8"> (port.</span><span style="color:#b392f0">bytesAvailable</span><span style="color:#e1e4e8">() </span><span style="color:#f97583">></span><span style="color:#79b8ff"> 0</span><span style="color:#e1e4e8">) {</span></span>
<span class="line"><span style="color:#e1e4e8">                buf.</span><span style="color:#b392f0">write</span><span style="color:#e1e4e8">(port.</span><span style="color:#b392f0">getInputStream</span><span style="color:#e1e4e8">().</span><span style="color:#b392f0">read</span><span style="color:#e1e4e8">());</span></span>
<span class="line"><span style="color:#f97583">                if</span><span style="color:#e1e4e8"> (term.</span><span style="color:#b392f0">test</span><span style="color:#e1e4e8">(buf.</span><span style="color:#b392f0">toByteArray</span><span style="color:#e1e4e8">())) {</span></span>
<span class="line"><span style="color:#f97583">                    return</span><span style="color:#e1e4e8"> buf.</span><span style="color:#b392f0">toByteArray</span><span style="color:#e1e4e8">();</span></span>
<span class="line"><span style="color:#e1e4e8">                }</span></span>
<span class="line"><span style="color:#e1e4e8">            }</span></span>
<span class="line"><span style="color:#e1e4e8">        }</span></span>
<span class="line"><span style="color:#f97583">        throw</span><span style="color:#f97583"> new</span><span style="color:#b392f0"> IOException</span><span style="color:#e1e4e8">(</span><span style="color:#9ecbff">"Resp timeout"</span><span style="color:#e1e4e8">);</span></span>
<span class="line"><span style="color:#e1e4e8">    }</span></span>
<span class="line"><span style="color:#e1e4e8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">=====</span><span style="color:#e1e4e8"> .</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">config</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">jpos.xml </span><span style="color:#f97583">=====</span></span>
<span class="line"><span style="color:#f97583">&#x3C;</span><span style="color:#e1e4e8">JposEntries</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">  &#x3C;</span><span style="color:#e1e4e8">JposEntry logicalName</span><span style="color:#f97583">=</span><span style="color:#9ecbff">"MYCASH"</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">    &#x3C;</span><span style="color:#e1e4e8">creation factoryClass</span><span style="color:#f97583">=</span><span style="color:#9ecbff">"org.javapos.services.SimpleServiceFactory"</span></span>
<span class="line"><span style="color:#e1e4e8">              serviceClass</span><span style="color:#f97583">=</span><span style="color:#9ecbff">"com.example.mybrand.MyCashChangerService"</span><span style="color:#f97583">/></span></span>
<span class="line"><span style="color:#f97583">    &#x3C;</span><span style="color:#e1e4e8">vendor name</span><span style="color:#f97583">=</span><span style="color:#9ecbff">"MyBrand"</span><span style="color:#f97583">/></span></span>
<span class="line"><span style="color:#f97583">    &#x3C;</span><span style="color:#e1e4e8">deviceCategory</span><span style="color:#f97583">></span><span style="color:#e1e4e8">CashChanger</span><span style="color:#f97583">&#x3C;/</span><span style="color:#e1e4e8">deviceCategory</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">    &#x3C;</span><span style="color:#e1e4e8">product name</span><span style="color:#f97583">=</span><span style="color:#9ecbff">"MyCashChanger"</span><span style="color:#f97583">/></span></span>
<span class="line"><span style="color:#f97583">    &#x3C;</span><span style="color:#e1e4e8">property name</span><span style="color:#f97583">=</span><span style="color:#9ecbff">"PortName"</span><span style="color:#e1e4e8"> value</span><span style="color:#f97583">=</span><span style="color:#9ecbff">"COM3"</span><span style="color:#f97583">/></span></span>
<span class="line"><span style="color:#f97583">  &#x3C;/</span><span style="color:#e1e4e8">JposEntry</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">&#x3C;/</span><span style="color:#e1e4e8">JposEntries</span><span style="color:#f97583">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">=====</span><span style="color:#e1e4e8"> .</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">pom.xml </span><span style="color:#f97583">=====</span></span>
<span class="line"><span style="color:#f97583">&#x3C;</span><span style="color:#e1e4e8">project xmlns</span><span style="color:#f97583">=</span><span style="color:#9ecbff">"http://maven.apache.org/POM/4.0.0"</span></span>
<span class="line"><span style="color:#e1e4e8">         xmlns</span><span style="color:#f97583">:</span><span style="color:#e1e4e8">xsi</span><span style="color:#f97583">=</span><span style="color:#9ecbff">"http://www.w3.org/2001/XMLSchema-instance"</span></span>
<span class="line"><span style="color:#e1e4e8">         xsi</span><span style="color:#f97583">:</span><span style="color:#e1e4e8">schemaLocation</span><span style="color:#f97583">=</span><span style="color:#9ecbff">"http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd"</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">  &#x3C;</span><span style="color:#e1e4e8">modelVersion</span><span style="color:#f97583">></span><span style="color:#79b8ff">4.0</span><span style="color:#e1e4e8">.</span><span style="color:#fdaeb7;font-style:italic">0</span><span style="color:#f97583">&#x3C;/</span><span style="color:#e1e4e8">modelVersion</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">  &#x3C;</span><span style="color:#e1e4e8">groupId</span><span style="color:#f97583">></span><span style="color:#e1e4e8">com.example</span><span style="color:#f97583">&#x3C;/</span><span style="color:#e1e4e8">groupId</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">  &#x3C;</span><span style="color:#e1e4e8">artifactId</span><span style="color:#f97583">></span><span style="color:#e1e4e8">pos</span><span style="color:#f97583">-</span><span style="color:#e1e4e8">solution</span><span style="color:#f97583">&#x3C;/</span><span style="color:#e1e4e8">artifactId</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">  &#x3C;</span><span style="color:#e1e4e8">version</span><span style="color:#f97583">></span><span style="color:#79b8ff">1.0</span><span style="color:#f97583">-</span><span style="color:#e1e4e8">SNAPSHOT</span><span style="color:#f97583">&#x3C;/</span><span style="color:#e1e4e8">version</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">  &#x3C;</span><span style="color:#e1e4e8">packaging</span><span style="color:#f97583">></span><span style="color:#e1e4e8">pom</span><span style="color:#f97583">&#x3C;/</span><span style="color:#e1e4e8">packaging</span><span style="color:#f97583">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">  &#x3C;</span><span style="color:#e1e4e8">modules</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">    &#x3C;</span><span style="color:#e1e4e8">module</span><span style="color:#f97583">></span><span style="color:#e1e4e8">control</span><span style="color:#f97583">-</span><span style="color:#e1e4e8">core</span><span style="color:#f97583">&#x3C;/</span><span style="color:#e1e4e8">module</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">    &#x3C;</span><span style="color:#e1e4e8">module</span><span style="color:#f97583">></span><span style="color:#e1e4e8">comm</span><span style="color:#f97583">-</span><span style="color:#e1e4e8">adapters</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">serial</span><span style="color:#f97583">-</span><span style="color:#e1e4e8">bridge</span><span style="color:#f97583">&#x3C;/</span><span style="color:#e1e4e8">module</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">    &#x3C;</span><span style="color:#e1e4e8">module</span><span style="color:#f97583">></span><span style="color:#e1e4e8">device</span><span style="color:#f97583">-</span><span style="color:#e1e4e8">mybrand</span><span style="color:#f97583">-</span><span style="color:#e1e4e8">cashchanger</span><span style="color:#f97583">&#x3C;/</span><span style="color:#e1e4e8">module</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">  &#x3C;/</span><span style="color:#e1e4e8">modules</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">&#x3C;/</span><span style="color:#e1e4e8">project</span><span style="color:#f97583">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">=====</span><span style="color:#e1e4e8"> .</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">control</span><span style="color:#f97583">-</span><span style="color:#e1e4e8">core</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">pom.xml </span><span style="color:#f97583">=====</span></span>
<span class="line"><span style="color:#f97583">&#x3C;</span><span style="color:#e1e4e8">project xmlns</span><span style="color:#f97583">=</span><span style="color:#9ecbff">"http://maven.apache.org/POM/4.0.0"</span></span>
<span class="line"><span style="color:#e1e4e8">         xmlns</span><span style="color:#f97583">:</span><span style="color:#e1e4e8">xsi</span><span style="color:#f97583">=</span><span style="color:#9ecbff">"http://www.w3.org/2001/XMLSchema-instance"</span></span>
<span class="line"><span style="color:#e1e4e8">         xsi</span><span style="color:#f97583">:</span><span style="color:#e1e4e8">schemaLocation</span><span style="color:#f97583">=</span><span style="color:#9ecbff">"http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd"</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">  &#x3C;</span><span style="color:#e1e4e8">modelVersion</span><span style="color:#f97583">></span><span style="color:#79b8ff">4.0</span><span style="color:#e1e4e8">.</span><span style="color:#fdaeb7;font-style:italic">0</span><span style="color:#f97583">&#x3C;/</span><span style="color:#e1e4e8">modelVersion</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">  &#x3C;</span><span style="color:#e1e4e8">parent</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">    &#x3C;</span><span style="color:#e1e4e8">groupId</span><span style="color:#f97583">></span><span style="color:#e1e4e8">com.example</span><span style="color:#f97583">&#x3C;/</span><span style="color:#e1e4e8">groupId</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">    &#x3C;</span><span style="color:#e1e4e8">artifactId</span><span style="color:#f97583">></span><span style="color:#e1e4e8">pos</span><span style="color:#f97583">-</span><span style="color:#e1e4e8">solution</span><span style="color:#f97583">&#x3C;/</span><span style="color:#e1e4e8">artifactId</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">    &#x3C;</span><span style="color:#e1e4e8">version</span><span style="color:#f97583">></span><span style="color:#79b8ff">1.0</span><span style="color:#f97583">-</span><span style="color:#e1e4e8">SNAPSHOT</span><span style="color:#f97583">&#x3C;/</span><span style="color:#e1e4e8">version</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">  &#x3C;/</span><span style="color:#e1e4e8">parent</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">  &#x3C;</span><span style="color:#e1e4e8">artifactId</span><span style="color:#f97583">></span><span style="color:#e1e4e8">control</span><span style="color:#f97583">-</span><span style="color:#e1e4e8">core</span><span style="color:#f97583">&#x3C;/</span><span style="color:#e1e4e8">artifactId</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">  &#x3C;</span><span style="color:#e1e4e8">dependencies</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">    &#x3C;!--</span><span style="color:#e1e4e8"> JavaPOS </span><span style="color:#b392f0">contracts</span><span style="color:#e1e4e8"> (bring your own jar) </span><span style="color:#f97583">--></span></span>
<span class="line"><span style="color:#f97583">    &#x3C;</span><span style="color:#e1e4e8">dependency</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">      &#x3C;</span><span style="color:#e1e4e8">groupId</span><span style="color:#f97583">></span><span style="color:#e1e4e8">org.javapos</span><span style="color:#f97583">&#x3C;/</span><span style="color:#e1e4e8">groupId</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">      &#x3C;</span><span style="color:#e1e4e8">artifactId</span><span style="color:#f97583">></span><span style="color:#e1e4e8">javapos</span><span style="color:#f97583">-</span><span style="color:#e1e4e8">contracts</span><span style="color:#f97583">&#x3C;/</span><span style="color:#e1e4e8">artifactId</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">      &#x3C;</span><span style="color:#e1e4e8">version</span><span style="color:#f97583">></span><span style="color:#79b8ff">1.14</span><span style="color:#e1e4e8">.</span><span style="color:#fdaeb7;font-style:italic">0</span><span style="color:#f97583">&#x3C;/</span><span style="color:#e1e4e8">version</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">      &#x3C;</span><span style="color:#e1e4e8">scope</span><span style="color:#f97583">></span><span style="color:#e1e4e8">provided</span><span style="color:#f97583">&#x3C;/</span><span style="color:#e1e4e8">scope</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">    &#x3C;/</span><span style="color:#e1e4e8">dependency</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">  &#x3C;/</span><span style="color:#e1e4e8">dependencies</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">&#x3C;/</span><span style="color:#e1e4e8">project</span><span style="color:#f97583">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">=====</span><span style="color:#e1e4e8"> .</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">control</span><span style="color:#f97583">-</span><span style="color:#e1e4e8">core</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">src</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">main</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">java</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">com</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">example</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">core</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">DeviceStateMachine.java </span><span style="color:#f97583">=====</span></span>
<span class="line"><span style="color:#f97583">package</span><span style="color:#e1e4e8"> com.example.core;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">import</span><span style="color:#e1e4e8"> java.util.concurrent.atomic.AtomicReference;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">public</span><span style="color:#f97583"> class</span><span style="color:#b392f0"> DeviceStateMachine</span><span style="color:#e1e4e8"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">    public</span><span style="color:#f97583"> enum</span><span style="color:#b392f0"> State</span><span style="color:#e1e4e8"> { </span><span style="color:#79b8ff">CLOSED</span><span style="color:#e1e4e8">, </span><span style="color:#79b8ff">CLAIMED</span><span style="color:#e1e4e8">, </span><span style="color:#79b8ff">ENABLED</span><span style="color:#e1e4e8">, </span><span style="color:#79b8ff">BUSY</span><span style="color:#e1e4e8">, </span><span style="color:#79b8ff">IDLE</span><span style="color:#e1e4e8">, </span><span style="color:#79b8ff">ERROR</span><span style="color:#e1e4e8"> }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">    private</span><span style="color:#f97583"> final</span><span style="color:#e1e4e8"> AtomicReference&#x3C;</span><span style="color:#f97583">State</span><span style="color:#e1e4e8">> state </span><span style="color:#f97583">=</span><span style="color:#f97583"> new</span><span style="color:#e1e4e8"> AtomicReference&#x3C;>(State.CLOSED);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">    public</span><span style="color:#e1e4e8"> State </span><span style="color:#b392f0">get</span><span style="color:#e1e4e8">() {</span></span>
<span class="line"><span style="color:#f97583">        return</span><span style="color:#e1e4e8"> state.</span><span style="color:#b392f0">get</span><span style="color:#e1e4e8">();</span></span>
<span class="line"><span style="color:#e1e4e8">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">    public</span><span style="color:#f97583"> void</span><span style="color:#b392f0"> transitionTo</span><span style="color:#e1e4e8">(State </span><span style="color:#ffab70">target</span><span style="color:#e1e4e8">) {</span></span>
<span class="line"><span style="color:#e1e4e8">        State prev </span><span style="color:#f97583">=</span><span style="color:#e1e4e8"> state.</span><span style="color:#b392f0">getAndSet</span><span style="color:#e1e4e8">(target);</span></span>
<span class="line"><span style="color:#6a737d">        // sanity: CLOSED -> ENABLED not allowed etc. (simplified)</span></span>
<span class="line"><span style="color:#e1e4e8">    }</span></span>
<span class="line"><span style="color:#e1e4e8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">=====</span><span style="color:#e1e4e8"> .</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">control</span><span style="color:#f97583">-</span><span style="color:#e1e4e8">core</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">src</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">main</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">java</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">com</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">example</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">core</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">AbstractCashChangerControl.java </span><span style="color:#f97583">=====</span></span>
<span class="line"><span style="color:#f97583">package</span><span style="color:#e1e4e8"> com.example.core;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">import</span><span style="color:#e1e4e8"> jpos.JposException;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">public</span><span style="color:#f97583"> abstract</span><span style="color:#f97583"> class</span><span style="color:#b392f0"> AbstractCashChangerControl</span><span style="color:#e1e4e8"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">    protected</span><span style="color:#f97583"> final</span><span style="color:#e1e4e8"> AbstractCashChangerService service;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">    protected</span><span style="color:#b392f0"> AbstractCashChangerControl</span><span style="color:#e1e4e8">(AbstractCashChangerService </span><span style="color:#ffab70">svc</span><span style="color:#e1e4e8">) {</span></span>
<span class="line"><span style="color:#79b8ff">        this</span><span style="color:#e1e4e8">.service </span><span style="color:#f97583">=</span><span style="color:#e1e4e8"> svc;</span></span>
<span class="line"><span style="color:#e1e4e8">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">    public</span><span style="color:#f97583"> synchronized</span><span style="color:#f97583"> void</span><span style="color:#b392f0"> dispenseCash</span><span style="color:#e1e4e8">(String </span><span style="color:#ffab70">combo</span><span style="color:#e1e4e8">) </span><span style="color:#f97583">throws</span><span style="color:#e1e4e8"> JposException {</span></span>
<span class="line"><span style="color:#e1e4e8">        service.</span><span style="color:#b392f0">runWithPolicy</span><span style="color:#e1e4e8">(Command.DISPENSE_CASH, combo);</span></span>
<span class="line"><span style="color:#e1e4e8">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">    public</span><span style="color:#f97583"> synchronized</span><span style="color:#e1e4e8"> Object </span><span style="color:#b392f0">readCashCounts</span><span style="color:#e1e4e8">() </span><span style="color:#f97583">throws</span><span style="color:#e1e4e8"> JposException {</span></span>
<span class="line"><span style="color:#f97583">        return</span><span style="color:#e1e4e8"> service.</span><span style="color:#b392f0">runWithPolicy</span><span style="color:#e1e4e8">(Command.READ_CASH_COUNTS);</span></span>
<span class="line"><span style="color:#e1e4e8">    }</span></span>
<span class="line"><span style="color:#e1e4e8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">=====</span><span style="color:#e1e4e8"> .</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">control</span><span style="color:#f97583">-</span><span style="color:#e1e4e8">core</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">src</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">main</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">java</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">com</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">example</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">core</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">RetryPolicy.java </span><span style="color:#f97583">=====</span></span>
<span class="line"><span style="color:#f97583">package</span><span style="color:#e1e4e8"> com.example.core;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">import</span><span style="color:#e1e4e8"> java.time.Duration;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">public</span><span style="color:#f97583"> record</span><span style="color:#b392f0"> RetryPolicy</span><span style="color:#e1e4e8">(Duration timeout, </span><span style="color:#f97583">int</span><span style="color:#e1e4e8"> maxRetries, </span><span style="color:#f97583">byte</span><span style="color:#e1e4e8">[] abortBytes) {</span></span>
<span class="line"><span style="color:#f97583">    public</span><span style="color:#f97583"> static</span><span style="color:#f97583"> final</span><span style="color:#e1e4e8"> RetryPolicy NONE </span><span style="color:#f97583">=</span><span style="color:#f97583"> new</span><span style="color:#b392f0"> RetryPolicy</span><span style="color:#e1e4e8">(Duration.</span><span style="color:#b392f0">ofSeconds</span><span style="color:#e1e4e8">(</span><span style="color:#79b8ff">5</span><span style="color:#e1e4e8">), </span><span style="color:#79b8ff">0</span><span style="color:#e1e4e8">, </span><span style="color:#f97583">new</span><span style="color:#f97583"> byte</span><span style="color:#e1e4e8">[</span><span style="color:#79b8ff">0</span><span style="color:#e1e4e8">]);</span></span>
<span class="line"><span style="color:#e1e4e8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">=====</span><span style="color:#e1e4e8"> .</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">control</span><span style="color:#f97583">-</span><span style="color:#e1e4e8">core</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">src</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">main</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">java</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">com</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">example</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">core</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">Command.java </span><span style="color:#f97583">=====</span></span>
<span class="line"><span style="color:#f97583">package</span><span style="color:#e1e4e8"> com.example.core;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">public</span><span style="color:#f97583"> enum</span><span style="color:#b392f0"> Command</span><span style="color:#e1e4e8"> {</span></span>
<span class="line"><span style="color:#79b8ff">    DISPENSE_CASH</span><span style="color:#e1e4e8">,</span></span>
<span class="line"><span style="color:#79b8ff">    READ_CASH_COUNTS</span><span style="color:#e1e4e8">,</span></span>
<span class="line"><span style="color:#79b8ff">    SMART_DISPENSE</span><span style="color:#e1e4e8">,</span></span>
<span class="line"><span style="color:#79b8ff">    DIRECT_IO</span></span>
<span class="line"><span style="color:#e1e4e8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">=====</span><span style="color:#e1e4e8"> .</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">control</span><span style="color:#f97583">-</span><span style="color:#e1e4e8">core</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">src</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">main</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">java</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">com</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">example</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">core</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">AbstractCashChangerService.java </span><span style="color:#f97583">=====</span></span>
<span class="line"><span style="color:#f97583">package</span><span style="color:#e1e4e8"> com.example.core;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">import</span><span style="color:#e1e4e8"> java.time.Duration;</span></span>
<span class="line"><span style="color:#f97583">import</span><span style="color:#e1e4e8"> java.util.Map;</span></span>
<span class="line"><span style="color:#f97583">import</span><span style="color:#e1e4e8"> java.util.concurrent.</span><span style="color:#79b8ff">*</span><span style="color:#e1e4e8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">import</span><span style="color:#e1e4e8"> jpos.JposException;</span></span>
<span class="line"><span style="color:#f97583">import</span><span style="color:#e1e4e8"> jpos.JposConst;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">public</span><span style="color:#f97583"> abstract</span><span style="color:#f97583"> class</span><span style="color:#b392f0"> AbstractCashChangerService</span><span style="color:#e1e4e8"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">    protected</span><span style="color:#f97583"> final</span><span style="color:#e1e4e8"> DeviceStateMachine sm </span><span style="color:#f97583">=</span><span style="color:#f97583"> new</span><span style="color:#b392f0"> DeviceStateMachine</span><span style="color:#e1e4e8">();</span></span>
<span class="line"><span style="color:#f97583">    protected</span><span style="color:#f97583"> final</span><span style="color:#e1e4e8"> ExecutorService executor </span><span style="color:#f97583">=</span><span style="color:#e1e4e8"> Executors.</span><span style="color:#b392f0">newSingleThreadExecutor</span><span style="color:#e1e4e8">();</span></span>
<span class="line"><span style="color:#f97583">    protected</span><span style="color:#e1e4e8"> Map&#x3C;</span><span style="color:#f97583">Command</span><span style="color:#e1e4e8">, </span><span style="color:#f97583">RetryPolicy</span><span style="color:#e1e4e8">> policyMap </span><span style="color:#f97583">=</span><span style="color:#e1e4e8"> Map.</span><span style="color:#b392f0">of</span><span style="color:#e1e4e8">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">    protected</span><span style="color:#f97583"> abstract</span><span style="color:#e1e4e8"> Object </span><span style="color:#b392f0">doExecute</span><span style="color:#e1e4e8">(Command </span><span style="color:#ffab70">cmd</span><span style="color:#e1e4e8">, Object... </span><span style="color:#ffab70">args</span><span style="color:#e1e4e8">) </span><span style="color:#f97583">throws</span><span style="color:#e1e4e8"> JposException;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">    public</span><span style="color:#e1e4e8"> Object </span><span style="color:#b392f0">runWithPolicy</span><span style="color:#e1e4e8">(Command </span><span style="color:#ffab70">cmd</span><span style="color:#e1e4e8">, Object... </span><span style="color:#ffab70">args</span><span style="color:#e1e4e8">) </span><span style="color:#f97583">throws</span><span style="color:#e1e4e8"> JposException {</span></span>
<span class="line"><span style="color:#e1e4e8">        RetryPolicy p </span><span style="color:#f97583">=</span><span style="color:#e1e4e8"> policyMap.</span><span style="color:#b392f0">getOrDefault</span><span style="color:#e1e4e8">(cmd, RetryPolicy.NONE);</span></span>
<span class="line"><span style="color:#f97583">        for</span><span style="color:#e1e4e8"> (</span><span style="color:#f97583">int</span><span style="color:#e1e4e8"> i </span><span style="color:#f97583">=</span><span style="color:#79b8ff"> 0</span><span style="color:#e1e4e8">; i </span><span style="color:#f97583">&#x3C;=</span><span style="color:#e1e4e8"> p.</span><span style="color:#b392f0">maxRetries</span><span style="color:#e1e4e8">(); i</span><span style="color:#f97583">++</span><span style="color:#e1e4e8">) {</span></span>
<span class="line"><span style="color:#f97583">            try</span><span style="color:#e1e4e8"> {</span></span>
<span class="line"><span style="color:#e1e4e8">                Future&#x3C;</span><span style="color:#f97583">Object</span><span style="color:#e1e4e8">> fut </span><span style="color:#f97583">=</span><span style="color:#e1e4e8"> executor.</span><span style="color:#b392f0">submit</span><span style="color:#e1e4e8">(() </span><span style="color:#f97583">-></span><span style="color:#b392f0"> doExecute</span><span style="color:#e1e4e8">(cmd, args));</span></span>
<span class="line"><span style="color:#f97583">                return</span><span style="color:#e1e4e8"> fut.</span><span style="color:#b392f0">get</span><span style="color:#e1e4e8">(p.</span><span style="color:#b392f0">timeout</span><span style="color:#e1e4e8">().</span><span style="color:#b392f0">toMillis</span><span style="color:#e1e4e8">(), TimeUnit.MILLISECONDS);</span></span>
<span class="line"><span style="color:#e1e4e8">            } </span><span style="color:#f97583">catch</span><span style="color:#e1e4e8"> (TimeoutException </span><span style="color:#ffab70">te</span><span style="color:#e1e4e8">) {</span></span>
<span class="line"><span style="color:#f97583">                if</span><span style="color:#e1e4e8"> (i </span><span style="color:#f97583">==</span><span style="color:#e1e4e8"> p.</span><span style="color:#b392f0">maxRetries</span><span style="color:#e1e4e8">()) {</span></span>
<span class="line"><span style="color:#6a737d">                    // would send abort here</span></span>
<span class="line"><span style="color:#f97583">                    throw</span><span style="color:#f97583"> new</span><span style="color:#b392f0"> JposException</span><span style="color:#e1e4e8">(JposConst.JPOS_E_TIMEOUT, </span><span style="color:#9ecbff">"Timeout &#x26; aborted"</span><span style="color:#e1e4e8">);</span></span>
<span class="line"><span style="color:#e1e4e8">                }</span></span>
<span class="line"><span style="color:#e1e4e8">            } </span><span style="color:#f97583">catch</span><span style="color:#e1e4e8"> (Exception </span><span style="color:#ffab70">e</span><span style="color:#e1e4e8">) {</span></span>
<span class="line"><span style="color:#f97583">                if</span><span style="color:#e1e4e8"> (e </span><span style="color:#f97583">instanceof</span><span style="color:#e1e4e8"> JposException je) </span><span style="color:#f97583">throw</span><span style="color:#e1e4e8"> je;</span></span>
<span class="line"><span style="color:#f97583">                throw</span><span style="color:#f97583"> new</span><span style="color:#b392f0"> JposException</span><span style="color:#e1e4e8">(JposConst.JPOS_E_FAILURE, e.</span><span style="color:#b392f0">getMessage</span><span style="color:#e1e4e8">());</span></span>
<span class="line"><span style="color:#e1e4e8">            }</span></span>
<span class="line"><span style="color:#e1e4e8">        }</span></span>
<span class="line"><span style="color:#f97583">        return</span><span style="color:#79b8ff"> null</span><span style="color:#e1e4e8">;</span></span>
<span class="line"><span style="color:#e1e4e8">    }</span></span>
<span class="line"><span style="color:#e1e4e8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">=====</span><span style="color:#e1e4e8"> .</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">device</span><span style="color:#f97583">-</span><span style="color:#e1e4e8">mybrand</span><span style="color:#f97583">-</span><span style="color:#e1e4e8">cashchanger</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">pom.xml </span><span style="color:#f97583">=====</span></span>
<span class="line"><span style="color:#f97583">&#x3C;</span><span style="color:#e1e4e8">project xmlns</span><span style="color:#f97583">=</span><span style="color:#9ecbff">"http://maven.apache.org/POM/4.0.0"</span></span>
<span class="line"><span style="color:#e1e4e8">         xmlns</span><span style="color:#f97583">:</span><span style="color:#e1e4e8">xsi</span><span style="color:#f97583">=</span><span style="color:#9ecbff">"http://www.w3.org/2001/XMLSchema-instance"</span></span>
<span class="line"><span style="color:#e1e4e8">         xsi</span><span style="color:#f97583">:</span><span style="color:#e1e4e8">schemaLocation</span><span style="color:#f97583">=</span><span style="color:#9ecbff">"http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd"</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">  &#x3C;</span><span style="color:#e1e4e8">modelVersion</span><span style="color:#f97583">></span><span style="color:#79b8ff">4.0</span><span style="color:#e1e4e8">.</span><span style="color:#fdaeb7;font-style:italic">0</span><span style="color:#f97583">&#x3C;/</span><span style="color:#e1e4e8">modelVersion</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">  &#x3C;</span><span style="color:#e1e4e8">parent</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">    &#x3C;</span><span style="color:#e1e4e8">groupId</span><span style="color:#f97583">></span><span style="color:#e1e4e8">com.example</span><span style="color:#f97583">&#x3C;/</span><span style="color:#e1e4e8">groupId</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">    &#x3C;</span><span style="color:#e1e4e8">artifactId</span><span style="color:#f97583">></span><span style="color:#e1e4e8">pos</span><span style="color:#f97583">-</span><span style="color:#e1e4e8">solution</span><span style="color:#f97583">&#x3C;/</span><span style="color:#e1e4e8">artifactId</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">    &#x3C;</span><span style="color:#e1e4e8">version</span><span style="color:#f97583">></span><span style="color:#79b8ff">1.0</span><span style="color:#f97583">-</span><span style="color:#e1e4e8">SNAPSHOT</span><span style="color:#f97583">&#x3C;/</span><span style="color:#e1e4e8">version</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">  &#x3C;/</span><span style="color:#e1e4e8">parent</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">  &#x3C;</span><span style="color:#e1e4e8">artifactId</span><span style="color:#f97583">></span><span style="color:#e1e4e8">device</span><span style="color:#f97583">-</span><span style="color:#e1e4e8">mybrand</span><span style="color:#f97583">-</span><span style="color:#e1e4e8">cashchanger</span><span style="color:#f97583">&#x3C;/</span><span style="color:#e1e4e8">artifactId</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">  &#x3C;</span><span style="color:#e1e4e8">dependencies</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">    &#x3C;</span><span style="color:#e1e4e8">dependency</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">      &#x3C;</span><span style="color:#e1e4e8">groupId</span><span style="color:#f97583">></span><span style="color:#e1e4e8">com.example</span><span style="color:#f97583">&#x3C;/</span><span style="color:#e1e4e8">groupId</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">      &#x3C;</span><span style="color:#e1e4e8">artifactId</span><span style="color:#f97583">></span><span style="color:#e1e4e8">control</span><span style="color:#f97583">-</span><span style="color:#e1e4e8">core</span><span style="color:#f97583">&#x3C;/</span><span style="color:#e1e4e8">artifactId</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">      &#x3C;</span><span style="color:#e1e4e8">version</span><span style="color:#f97583">></span><span style="color:#79b8ff">1.0</span><span style="color:#f97583">-</span><span style="color:#e1e4e8">SNAPSHOT</span><span style="color:#f97583">&#x3C;/</span><span style="color:#e1e4e8">version</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">    &#x3C;/</span><span style="color:#e1e4e8">dependency</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">    &#x3C;</span><span style="color:#e1e4e8">dependency</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">      &#x3C;</span><span style="color:#e1e4e8">groupId</span><span style="color:#f97583">></span><span style="color:#e1e4e8">com.example</span><span style="color:#f97583">&#x3C;/</span><span style="color:#e1e4e8">groupId</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">      &#x3C;</span><span style="color:#e1e4e8">artifactId</span><span style="color:#f97583">></span><span style="color:#e1e4e8">serial</span><span style="color:#f97583">-</span><span style="color:#e1e4e8">bridge</span><span style="color:#f97583">&#x3C;/</span><span style="color:#e1e4e8">artifactId</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">      &#x3C;</span><span style="color:#e1e4e8">version</span><span style="color:#f97583">></span><span style="color:#79b8ff">1.0</span><span style="color:#f97583">-</span><span style="color:#e1e4e8">SNAPSHOT</span><span style="color:#f97583">&#x3C;/</span><span style="color:#e1e4e8">version</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">    &#x3C;/</span><span style="color:#e1e4e8">dependency</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">  &#x3C;/</span><span style="color:#e1e4e8">dependencies</span><span style="color:#f97583">></span></span>
<span class="line"><span style="color:#f97583">&#x3C;/</span><span style="color:#e1e4e8">project</span><span style="color:#f97583">></span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">=====</span><span style="color:#e1e4e8"> .</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">device</span><span style="color:#f97583">-</span><span style="color:#e1e4e8">mybrand</span><span style="color:#f97583">-</span><span style="color:#e1e4e8">cashchanger</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">src</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">main</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">resources</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">META</span><span style="color:#f97583">-</span><span style="color:#e1e4e8">INF</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">services</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">jpos.services.CashChangerService113 </span><span style="color:#f97583">=====</span></span>
<span class="line"><span style="color:#e1e4e8">com.example.mybrand.MyCashChangerService</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">=====</span><span style="color:#e1e4e8"> .</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">device</span><span style="color:#f97583">-</span><span style="color:#e1e4e8">mybrand</span><span style="color:#f97583">-</span><span style="color:#e1e4e8">cashchanger</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">src</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">main</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">resources</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">MyRetryPolicy.yml </span><span style="color:#f97583">=====</span></span>
<span class="line"><span style="color:#e1e4e8">DISPENSE_CASH</span><span style="color:#f97583">:</span></span>
<span class="line"><span style="color:#e1e4e8">  timeout</span><span style="color:#f97583">:</span><span style="color:#e1e4e8"> 2s</span></span>
<span class="line"><span style="color:#e1e4e8">  maxRetries</span><span style="color:#f97583">:</span><span style="color:#79b8ff"> 1</span></span>
<span class="line"><span style="color:#e1e4e8">  abortHex</span><span style="color:#f97583">:</span><span style="color:#9ecbff"> "18"</span></span>
<span class="line"><span style="color:#e1e4e8">SMART_DISPENSE</span><span style="color:#f97583">:</span></span>
<span class="line"><span style="color:#e1e4e8">  timeout</span><span style="color:#f97583">:</span><span style="color:#e1e4e8"> 5s</span></span>
<span class="line"><span style="color:#e1e4e8">  maxRetries</span><span style="color:#f97583">:</span><span style="color:#79b8ff"> 1</span></span>
<span class="line"><span style="color:#e1e4e8">  abortHex</span><span style="color:#f97583">:</span><span style="color:#9ecbff"> "18"</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">=====</span><span style="color:#e1e4e8"> .</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">device</span><span style="color:#f97583">-</span><span style="color:#e1e4e8">mybrand</span><span style="color:#f97583">-</span><span style="color:#e1e4e8">cashchanger</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">src</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">main</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">java</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">com</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">example</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">mybrand</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">MyCashChangerService.java </span><span style="color:#f97583">=====</span></span>
<span class="line"><span style="color:#f97583">package</span><span style="color:#e1e4e8"> com.example.mybrand;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">import</span><span style="color:#e1e4e8"> com.example.core.</span><span style="color:#79b8ff">*</span><span style="color:#e1e4e8">;</span></span>
<span class="line"><span style="color:#f97583">import</span><span style="color:#e1e4e8"> com.example.bridge.SerialBridge;</span></span>
<span class="line"><span style="color:#f97583">import</span><span style="color:#e1e4e8"> jpos.JposException;</span></span>
<span class="line"><span style="color:#f97583">import</span><span style="color:#e1e4e8"> jpos.JposConst;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">import</span><span style="color:#e1e4e8"> java.time.Duration;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">public</span><span style="color:#f97583"> class</span><span style="color:#b392f0"> MyCashChangerService</span><span style="color:#f97583"> extends</span><span style="color:#b392f0"> AbstractCashChangerService</span><span style="color:#e1e4e8"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">    private</span><span style="color:#f97583"> final</span><span style="color:#e1e4e8"> MyCashChangerCodec codec </span><span style="color:#f97583">=</span><span style="color:#f97583"> new</span><span style="color:#b392f0"> MyCashChangerCodec</span><span style="color:#e1e4e8">();</span></span>
<span class="line"><span style="color:#f97583">    private</span><span style="color:#f97583"> final</span><span style="color:#e1e4e8"> SerialBridge bridge </span><span style="color:#f97583">=</span><span style="color:#f97583"> new</span><span style="color:#b392f0"> MyCashChangerBridge</span><span style="color:#e1e4e8">(</span><span style="color:#9ecbff">"COM3"</span><span style="color:#e1e4e8">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">    public</span><span style="color:#b392f0"> MyCashChangerService</span><span style="color:#e1e4e8">() {</span></span>
<span class="line"><span style="color:#e1e4e8">        policyMap </span><span style="color:#f97583">=</span><span style="color:#e1e4e8"> java.util.Map.</span><span style="color:#b392f0">of</span><span style="color:#e1e4e8">(</span></span>
<span class="line"><span style="color:#e1e4e8">            Command.DISPENSE_CASH, </span><span style="color:#f97583">new</span><span style="color:#b392f0"> RetryPolicy</span><span style="color:#e1e4e8">(Duration.</span><span style="color:#b392f0">ofSeconds</span><span style="color:#e1e4e8">(</span><span style="color:#79b8ff">2</span><span style="color:#e1e4e8">),</span><span style="color:#79b8ff">1</span><span style="color:#e1e4e8">,codec.</span><span style="color:#b392f0">abort</span><span style="color:#e1e4e8">()),</span></span>
<span class="line"><span style="color:#e1e4e8">            Command.SMART_DISPENSE, </span><span style="color:#f97583">new</span><span style="color:#b392f0"> RetryPolicy</span><span style="color:#e1e4e8">(Duration.</span><span style="color:#b392f0">ofSeconds</span><span style="color:#e1e4e8">(</span><span style="color:#79b8ff">5</span><span style="color:#e1e4e8">),</span><span style="color:#79b8ff">1</span><span style="color:#e1e4e8">,codec.</span><span style="color:#b392f0">abort</span><span style="color:#e1e4e8">())</span></span>
<span class="line"><span style="color:#e1e4e8">        );</span></span>
<span class="line"><span style="color:#e1e4e8">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#e1e4e8">    @</span><span style="color:#f97583">Override</span></span>
<span class="line"><span style="color:#f97583">    protected</span><span style="color:#e1e4e8"> Object </span><span style="color:#b392f0">doExecute</span><span style="color:#e1e4e8">(Command </span><span style="color:#ffab70">cmd</span><span style="color:#e1e4e8">, Object... </span><span style="color:#ffab70">args</span><span style="color:#e1e4e8">) </span><span style="color:#f97583">throws</span><span style="color:#e1e4e8"> JposException {</span></span>
<span class="line"><span style="color:#f97583">        try</span><span style="color:#e1e4e8"> {</span></span>
<span class="line"><span style="color:#f97583">            switch</span><span style="color:#e1e4e8"> (cmd) {</span></span>
<span class="line"><span style="color:#f97583">                case</span><span style="color:#e1e4e8"> DISPENSE_CASH </span><span style="color:#f97583">-></span><span style="color:#e1e4e8"> {</span></span>
<span class="line"><span style="color:#e1e4e8">                    String combo </span><span style="color:#f97583">=</span><span style="color:#e1e4e8"> (String) args[</span><span style="color:#79b8ff">0</span><span style="color:#e1e4e8">];</span></span>
<span class="line"><span style="color:#e1e4e8">                    bridge.</span><span style="color:#b392f0">write</span><span style="color:#e1e4e8">(codec.</span><span style="color:#b392f0">encodeDispense</span><span style="color:#e1e4e8">(combo));</span></span>
<span class="line"><span style="color:#e1e4e8">                    bridge.</span><span style="color:#b392f0">expectAck</span><span style="color:#e1e4e8">(Duration.</span><span style="color:#b392f0">ofSeconds</span><span style="color:#e1e4e8">(</span><span style="color:#79b8ff">2</span><span style="color:#e1e4e8">));</span></span>
<span class="line"><span style="color:#f97583">                    return</span><span style="color:#79b8ff"> null</span><span style="color:#e1e4e8">;</span></span>
<span class="line"><span style="color:#e1e4e8">                }</span></span>
<span class="line"><span style="color:#f97583">                case</span><span style="color:#e1e4e8"> READ_CASH_COUNTS </span><span style="color:#f97583">-></span><span style="color:#e1e4e8"> {</span></span>
<span class="line"><span style="color:#e1e4e8">                    bridge.</span><span style="color:#b392f0">write</span><span style="color:#e1e4e8">(</span><span style="color:#9ecbff">"CNT?</span><span style="color:#79b8ff">\r\n</span><span style="color:#9ecbff">"</span><span style="color:#e1e4e8">.</span><span style="color:#b392f0">getBytes</span><span style="color:#e1e4e8">());</span></span>
<span class="line"><span style="color:#e1e4e8">                    bridge.</span><span style="color:#b392f0">expectAck</span><span style="color:#e1e4e8">(Duration.</span><span style="color:#b392f0">ofSeconds</span><span style="color:#e1e4e8">(</span><span style="color:#79b8ff">1</span><span style="color:#e1e4e8">));</span></span>
<span class="line"><span style="color:#f97583">                    byte</span><span style="color:#e1e4e8">[] resp </span><span style="color:#f97583">=</span><span style="color:#e1e4e8"> bridge.</span><span style="color:#b392f0">readResponse</span><span style="color:#e1e4e8">(Duration.</span><span style="color:#b392f0">ofSeconds</span><span style="color:#e1e4e8">(</span><span style="color:#79b8ff">2</span><span style="color:#e1e4e8">), codec.</span><span style="color:#b392f0">respEndForCounts</span><span style="color:#e1e4e8">());</span></span>
<span class="line"><span style="color:#f97583">                    return</span><span style="color:#f97583"> new</span><span style="color:#b392f0"> String</span><span style="color:#e1e4e8">(resp); </span><span style="color:#6a737d">// placeholder</span></span>
<span class="line"><span style="color:#e1e4e8">                }</span></span>
<span class="line"><span style="color:#f97583">                case</span><span style="color:#e1e4e8"> SMART_DISPENSE </span><span style="color:#f97583">-></span><span style="color:#e1e4e8"> {</span></span>
<span class="line"><span style="color:#f97583">                    int</span><span style="color:#e1e4e8"> amount </span><span style="color:#f97583">=</span><span style="color:#e1e4e8"> (Integer) args[</span><span style="color:#79b8ff">0</span><span style="color:#e1e4e8">];</span></span>
<span class="line"><span style="color:#e1e4e8">                    String combo </span><span style="color:#f97583">=</span><span style="color:#9ecbff"> "1000,1"</span><span style="color:#e1e4e8">; </span><span style="color:#6a737d">// placeholder calc</span></span>
<span class="line"><span style="color:#e1e4e8">                    bridge.</span><span style="color:#b392f0">write</span><span style="color:#e1e4e8">(codec.</span><span style="color:#b392f0">encodeDispense</span><span style="color:#e1e4e8">(combo));</span></span>
<span class="line"><span style="color:#e1e4e8">                    bridge.</span><span style="color:#b392f0">expectAck</span><span style="color:#e1e4e8">(Duration.</span><span style="color:#b392f0">ofSeconds</span><span style="color:#e1e4e8">(</span><span style="color:#79b8ff">2</span><span style="color:#e1e4e8">));</span></span>
<span class="line"><span style="color:#f97583">                    byte</span><span style="color:#e1e4e8">[] res </span><span style="color:#f97583">=</span><span style="color:#e1e4e8"> bridge.</span><span style="color:#b392f0">readResponse</span><span style="color:#e1e4e8">(Duration.</span><span style="color:#b392f0">ofSeconds</span><span style="color:#e1e4e8">(</span><span style="color:#79b8ff">3</span><span style="color:#e1e4e8">), codec</span><span style="color:#f97583">::</span><span style="color:#e1e4e8">isSmartDispenseEnd);</span></span>
<span class="line"><span style="color:#6a737d">                    // In real impl, parse and fire event</span></span>
<span class="line"><span style="color:#f97583">                    return</span><span style="color:#79b8ff"> null</span><span style="color:#e1e4e8">;</span></span>
<span class="line"><span style="color:#e1e4e8">                }</span></span>
<span class="line"><span style="color:#f97583">                default</span><span style="color:#f97583"> -></span><span style="color:#f97583"> throw</span><span style="color:#f97583"> new</span><span style="color:#b392f0"> JposException</span><span style="color:#e1e4e8">(JposConst.JPOS_E_ILLEGAL, </span><span style="color:#9ecbff">"Unsupported cmd"</span><span style="color:#e1e4e8">);</span></span>
<span class="line"><span style="color:#e1e4e8">            }</span></span>
<span class="line"><span style="color:#e1e4e8">        } </span><span style="color:#f97583">catch</span><span style="color:#e1e4e8"> (Exception </span><span style="color:#ffab70">e</span><span style="color:#e1e4e8">) {</span></span>
<span class="line"><span style="color:#f97583">            if</span><span style="color:#e1e4e8"> (e </span><span style="color:#f97583">instanceof</span><span style="color:#e1e4e8"> JposException je) </span><span style="color:#f97583">throw</span><span style="color:#e1e4e8"> je;</span></span>
<span class="line"><span style="color:#f97583">            throw</span><span style="color:#f97583"> new</span><span style="color:#b392f0"> JposException</span><span style="color:#e1e4e8">(JposConst.JPOS_E_FAILURE, e.</span><span style="color:#b392f0">getMessage</span><span style="color:#e1e4e8">());</span></span>
<span class="line"><span style="color:#e1e4e8">        }</span></span>
<span class="line"><span style="color:#e1e4e8">    }</span></span>
<span class="line"><span style="color:#e1e4e8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">=====</span><span style="color:#e1e4e8"> .</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">device</span><span style="color:#f97583">-</span><span style="color:#e1e4e8">mybrand</span><span style="color:#f97583">-</span><span style="color:#e1e4e8">cashchanger</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">src</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">main</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">java</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">com</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">example</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">mybrand</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">MyCashChangerControlEx.java </span><span style="color:#f97583">=====</span></span>
<span class="line"><span style="color:#f97583">package</span><span style="color:#e1e4e8"> com.example.mybrand;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">import</span><span style="color:#e1e4e8"> jpos.JposException;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">public</span><span style="color:#f97583"> interface</span><span style="color:#b392f0"> MyCashChangerControlEx</span><span style="color:#e1e4e8"> {</span></span>
<span class="line"><span style="color:#f97583">    void</span><span style="color:#b392f0"> smartDispense</span><span style="color:#e1e4e8">(</span><span style="color:#f97583">int</span><span style="color:#ffab70"> amountYen</span><span style="color:#e1e4e8">) </span><span style="color:#f97583">throws</span><span style="color:#e1e4e8"> JposException;</span></span>
<span class="line"><span style="color:#e1e4e8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">=====</span><span style="color:#e1e4e8"> .</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">device</span><span style="color:#f97583">-</span><span style="color:#e1e4e8">mybrand</span><span style="color:#f97583">-</span><span style="color:#e1e4e8">cashchanger</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">src</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">main</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">java</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">com</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">example</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">mybrand</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">MyCashChangerCodec.java </span><span style="color:#f97583">=====</span></span>
<span class="line"><span style="color:#f97583">package</span><span style="color:#e1e4e8"> com.example.mybrand;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">import</span><span style="color:#e1e4e8"> java.util.function.Predicate;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">public</span><span style="color:#f97583"> class</span><span style="color:#b392f0"> MyCashChangerCodec</span><span style="color:#e1e4e8"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">    public</span><span style="color:#f97583"> byte</span><span style="color:#e1e4e8">[] </span><span style="color:#b392f0">encodeDispense</span><span style="color:#e1e4e8">(String </span><span style="color:#ffab70">combo</span><span style="color:#e1e4e8">) {</span></span>
<span class="line"><span style="color:#f97583">        return</span><span style="color:#e1e4e8"> (combo </span><span style="color:#f97583">+</span><span style="color:#9ecbff"> "</span><span style="color:#79b8ff">\r\n</span><span style="color:#9ecbff">"</span><span style="color:#e1e4e8">).</span><span style="color:#b392f0">getBytes</span><span style="color:#e1e4e8">();</span></span>
<span class="line"><span style="color:#e1e4e8">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">    public</span><span style="color:#e1e4e8"> Predicate&#x3C;</span><span style="color:#f97583">byte</span><span style="color:#e1e4e8">[]> </span><span style="color:#b392f0">respEndForCounts</span><span style="color:#e1e4e8">() {</span></span>
<span class="line"><span style="color:#f97583">        return</span><span style="color:#e1e4e8"> bytes </span><span style="color:#f97583">-></span><span style="color:#e1e4e8"> bytes.length </span><span style="color:#f97583">>=</span><span style="color:#79b8ff"> 24</span><span style="color:#e1e4e8">;</span></span>
<span class="line"><span style="color:#e1e4e8">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">    public</span><span style="color:#f97583"> boolean</span><span style="color:#b392f0"> isSmartDispenseEnd</span><span style="color:#e1e4e8">(</span><span style="color:#f97583">byte</span><span style="color:#e1e4e8">[] </span><span style="color:#ffab70">bytes</span><span style="color:#e1e4e8">) {</span></span>
<span class="line"><span style="color:#f97583">        return</span><span style="color:#e1e4e8"> bytes.length </span><span style="color:#f97583">></span><span style="color:#79b8ff"> 0</span><span style="color:#f97583"> &#x26;&#x26;</span><span style="color:#e1e4e8"> bytes[bytes.length</span><span style="color:#f97583">-</span><span style="color:#79b8ff">1</span><span style="color:#e1e4e8">] </span><span style="color:#f97583">==</span><span style="color:#9ecbff"> '</span><span style="color:#79b8ff">\n</span><span style="color:#9ecbff">'</span><span style="color:#e1e4e8">;</span></span>
<span class="line"><span style="color:#e1e4e8">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">    public</span><span style="color:#f97583"> byte</span><span style="color:#e1e4e8">[] </span><span style="color:#b392f0">abort</span><span style="color:#e1e4e8">() {</span></span>
<span class="line"><span style="color:#f97583">        return</span><span style="color:#f97583"> new</span><span style="color:#f97583"> byte</span><span style="color:#e1e4e8">[]{</span><span style="color:#79b8ff">0x18</span><span style="color:#e1e4e8">}; </span><span style="color:#6a737d">// CAN</span></span>
<span class="line"><span style="color:#e1e4e8">    }</span></span>
<span class="line"><span style="color:#e1e4e8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">=====</span><span style="color:#e1e4e8"> .</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">device</span><span style="color:#f97583">-</span><span style="color:#e1e4e8">mybrand</span><span style="color:#f97583">-</span><span style="color:#e1e4e8">cashchanger</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">src</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">main</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">java</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">com</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">example</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">mybrand</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">MyCashChangerControl.java </span><span style="color:#f97583">=====</span></span>
<span class="line"><span style="color:#f97583">package</span><span style="color:#e1e4e8"> com.example.mybrand;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">import</span><span style="color:#e1e4e8"> com.example.core.</span><span style="color:#79b8ff">*</span><span style="color:#e1e4e8">;</span></span>
<span class="line"><span style="color:#f97583">import</span><span style="color:#e1e4e8"> jpos.JposException;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">public</span><span style="color:#f97583"> class</span><span style="color:#b392f0"> MyCashChangerControl</span><span style="color:#f97583"> extends</span><span style="color:#b392f0"> AbstractCashChangerControl</span><span style="color:#f97583"> implements</span><span style="color:#b392f0"> MyCashChangerControlEx</span><span style="color:#e1e4e8"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">    public</span><span style="color:#b392f0"> MyCashChangerControl</span><span style="color:#e1e4e8">() {</span></span>
<span class="line"><span style="color:#79b8ff">        super</span><span style="color:#e1e4e8">(</span><span style="color:#f97583">new</span><span style="color:#b392f0"> MyCashChangerService</span><span style="color:#e1e4e8">());</span></span>
<span class="line"><span style="color:#e1e4e8">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#e1e4e8">    @</span><span style="color:#f97583">Override</span></span>
<span class="line"><span style="color:#f97583">    public</span><span style="color:#f97583"> void</span><span style="color:#b392f0"> smartDispense</span><span style="color:#e1e4e8">(</span><span style="color:#f97583">int</span><span style="color:#ffab70"> amountYen</span><span style="color:#e1e4e8">) </span><span style="color:#f97583">throws</span><span style="color:#e1e4e8"> JposException {</span></span>
<span class="line"><span style="color:#e1e4e8">        service.</span><span style="color:#b392f0">runWithPolicy</span><span style="color:#e1e4e8">(Command.SMART_DISPENSE, amountYen);</span></span>
<span class="line"><span style="color:#e1e4e8">    }</span></span>
<span class="line"><span style="color:#e1e4e8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">=====</span><span style="color:#e1e4e8"> .</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">device</span><span style="color:#f97583">-</span><span style="color:#e1e4e8">mybrand</span><span style="color:#f97583">-</span><span style="color:#e1e4e8">cashchanger</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">src</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">main</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">java</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">com</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">example</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">mybrand</span><span style="color:#f97583">/</span><span style="color:#e1e4e8">MyCashChangerBridge.java </span><span style="color:#f97583">=====</span></span>
<span class="line"><span style="color:#f97583">package</span><span style="color:#e1e4e8"> com.example.mybrand;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">import</span><span style="color:#e1e4e8"> com.example.bridge.SerialBridge;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">public</span><span style="color:#f97583"> class</span><span style="color:#b392f0"> MyCashChangerBridge</span><span style="color:#f97583"> extends</span><span style="color:#b392f0"> SerialBridge</span><span style="color:#e1e4e8"> {</span></span>
<span class="line"><span style="color:#f97583">    public</span><span style="color:#b392f0"> MyCashChangerBridge</span><span style="color:#e1e4e8">(String </span><span style="color:#ffab70">port</span><span style="color:#e1e4e8">) {</span></span>
<span class="line"><span style="color:#79b8ff">        super</span><span style="color:#e1e4e8">(port);</span></span>
<span class="line"><span style="color:#e1e4e8">    }</span></span>
<span class="line"><span style="color:#e1e4e8">}</span></span>
<span class="line"></span></code></pre><pre class="astro-code github-dark" data-language="shell" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0"><code><span class="line"><span style="color:#b392f0">tree</span><span style="color:#9ecbff"> .</span></span>
<span class="line"><span style="color:#79b8ff">.</span></span>
<span class="line"><span style="color:#b392f0">â”œâ”€â”€</span><span style="color:#9ecbff"> comm-adapters</span></span>
<span class="line"><span style="color:#b392f0">â”‚Â Â </span><span style="color:#9ecbff"> â””â”€â”€</span><span style="color:#9ecbff"> serial-bridge</span></span>
<span class="line"><span style="color:#b392f0">â”‚Â Â </span><span style="color:#9ecbff">     â”œâ”€â”€</span><span style="color:#9ecbff"> pom.xml</span></span>
<span class="line"><span style="color:#b392f0">â”‚Â Â </span><span style="color:#9ecbff">     â””â”€â”€</span><span style="color:#9ecbff"> src</span></span>
<span class="line"><span style="color:#b392f0">â”‚Â Â </span><span style="color:#9ecbff">         â””â”€â”€</span><span style="color:#9ecbff"> main</span></span>
<span class="line"><span style="color:#b392f0">â”‚Â Â </span><span style="color:#9ecbff">             â””â”€â”€</span><span style="color:#9ecbff"> java</span></span>
<span class="line"><span style="color:#b392f0">â”‚Â Â </span><span style="color:#9ecbff">                 â””â”€â”€</span><span style="color:#9ecbff"> com</span></span>
<span class="line"><span style="color:#b392f0">â”‚Â Â </span><span style="color:#9ecbff">                     â””â”€â”€</span><span style="color:#9ecbff"> example</span></span>
<span class="line"><span style="color:#b392f0">â”‚Â Â </span><span style="color:#9ecbff">                         â””â”€â”€</span><span style="color:#9ecbff"> bridge</span></span>
<span class="line"><span style="color:#b392f0">â”‚Â Â </span><span style="color:#9ecbff">                             â””â”€â”€</span><span style="color:#9ecbff"> SerialBridge.java</span></span>
<span class="line"><span style="color:#b392f0">â”œâ”€â”€</span><span style="color:#9ecbff"> config</span></span>
<span class="line"><span style="color:#b392f0">â”‚Â Â </span><span style="color:#9ecbff"> â””â”€â”€</span><span style="color:#9ecbff"> jpos.xml</span></span>
<span class="line"><span style="color:#b392f0">â”œâ”€â”€</span><span style="color:#9ecbff"> control-core</span></span>
<span class="line"><span style="color:#b392f0">â”‚Â Â </span><span style="color:#9ecbff"> â”œâ”€â”€</span><span style="color:#9ecbff"> pom.xml</span></span>
<span class="line"><span style="color:#b392f0">â”‚Â Â </span><span style="color:#9ecbff"> â””â”€â”€</span><span style="color:#9ecbff"> src</span></span>
<span class="line"><span style="color:#b392f0">â”‚Â Â </span><span style="color:#9ecbff">     â””â”€â”€</span><span style="color:#9ecbff"> main</span></span>
<span class="line"><span style="color:#b392f0">â”‚Â Â </span><span style="color:#9ecbff">         â””â”€â”€</span><span style="color:#9ecbff"> java</span></span>
<span class="line"><span style="color:#b392f0">â”‚Â Â </span><span style="color:#9ecbff">             â””â”€â”€</span><span style="color:#9ecbff"> com</span></span>
<span class="line"><span style="color:#b392f0">â”‚Â Â </span><span style="color:#9ecbff">                 â””â”€â”€</span><span style="color:#9ecbff"> example</span></span>
<span class="line"><span style="color:#b392f0">â”‚Â Â </span><span style="color:#9ecbff">                     â””â”€â”€</span><span style="color:#9ecbff"> core</span></span>
<span class="line"><span style="color:#b392f0">â”‚Â Â </span><span style="color:#9ecbff">                         â”œâ”€â”€</span><span style="color:#9ecbff"> AbstractCashChangerControl.java</span></span>
<span class="line"><span style="color:#b392f0">â”‚Â Â </span><span style="color:#9ecbff">                         â”œâ”€â”€</span><span style="color:#9ecbff"> AbstractCashChangerService.java</span></span>
<span class="line"><span style="color:#b392f0">â”‚Â Â </span><span style="color:#9ecbff">                         â”œâ”€â”€</span><span style="color:#9ecbff"> Command.java</span></span>
<span class="line"><span style="color:#b392f0">â”‚Â Â </span><span style="color:#9ecbff">                         â”œâ”€â”€</span><span style="color:#9ecbff"> DeviceStateMachine.java</span></span>
<span class="line"><span style="color:#b392f0">â”‚Â Â </span><span style="color:#9ecbff">                         â””â”€â”€</span><span style="color:#9ecbff"> RetryPolicy.java</span></span>
<span class="line"><span style="color:#b392f0">â”œâ”€â”€</span><span style="color:#9ecbff"> device-mybrand-cashchanger</span></span>
<span class="line"><span style="color:#b392f0">â”‚Â Â </span><span style="color:#9ecbff"> â”œâ”€â”€</span><span style="color:#9ecbff"> pom.xml</span></span>
<span class="line"><span style="color:#b392f0">â”‚Â Â </span><span style="color:#9ecbff"> â””â”€â”€</span><span style="color:#9ecbff"> src</span></span>
<span class="line"><span style="color:#b392f0">â”‚Â Â </span><span style="color:#9ecbff">     â””â”€â”€</span><span style="color:#9ecbff"> main</span></span>
<span class="line"><span style="color:#b392f0">â”‚Â Â </span><span style="color:#9ecbff">         â”œâ”€â”€</span><span style="color:#9ecbff"> java</span></span>
<span class="line"><span style="color:#b392f0">â”‚Â Â </span><span style="color:#9ecbff">         â”‚Â Â </span><span style="color:#9ecbff"> â””â”€â”€</span><span style="color:#9ecbff"> com</span></span>
<span class="line"><span style="color:#b392f0">â”‚Â Â </span><span style="color:#9ecbff">         â”‚Â Â </span><span style="color:#9ecbff">     â””â”€â”€</span><span style="color:#9ecbff"> example</span></span>
<span class="line"><span style="color:#b392f0">â”‚Â Â </span><span style="color:#9ecbff">         â”‚Â Â </span><span style="color:#9ecbff">         â””â”€â”€</span><span style="color:#9ecbff"> mybrand</span></span>
<span class="line"><span style="color:#b392f0">â”‚Â Â </span><span style="color:#9ecbff">         â”‚Â Â </span><span style="color:#9ecbff">             â”œâ”€â”€</span><span style="color:#9ecbff"> MyCashChangerBridge.java</span></span>
<span class="line"><span style="color:#b392f0">â”‚Â Â </span><span style="color:#9ecbff">         â”‚Â Â </span><span style="color:#9ecbff">             â”œâ”€â”€</span><span style="color:#9ecbff"> MyCashChangerCodec.java</span></span>
<span class="line"><span style="color:#b392f0">â”‚Â Â </span><span style="color:#9ecbff">         â”‚Â Â </span><span style="color:#9ecbff">             â”œâ”€â”€</span><span style="color:#9ecbff"> MyCashChangerControl.java</span></span>
<span class="line"><span style="color:#b392f0">â”‚Â Â </span><span style="color:#9ecbff">         â”‚Â Â </span><span style="color:#9ecbff">             â”œâ”€â”€</span><span style="color:#9ecbff"> MyCashChangerControlEx.java</span></span>
<span class="line"><span style="color:#b392f0">â”‚Â Â </span><span style="color:#9ecbff">         â”‚Â Â </span><span style="color:#9ecbff">             â””â”€â”€</span><span style="color:#9ecbff"> MyCashChangerService.java</span></span>
<span class="line"><span style="color:#b392f0">â”‚Â Â </span><span style="color:#9ecbff">         â””â”€â”€</span><span style="color:#9ecbff"> resources</span></span>
<span class="line"><span style="color:#b392f0">â”‚Â Â </span><span style="color:#9ecbff">             â”œâ”€â”€</span><span style="color:#9ecbff"> META-INF</span></span>
<span class="line"><span style="color:#b392f0">â”‚Â Â </span><span style="color:#9ecbff">             â”‚Â Â </span><span style="color:#9ecbff"> â””â”€â”€</span><span style="color:#9ecbff"> services</span></span>
<span class="line"><span style="color:#b392f0">â”‚Â Â </span><span style="color:#9ecbff">             â”‚Â Â </span><span style="color:#9ecbff">     â””â”€â”€</span><span style="color:#9ecbff"> jpos.services.CashChangerService113</span></span>
<span class="line"><span style="color:#b392f0">â”‚Â Â </span><span style="color:#9ecbff">             â””â”€â”€</span><span style="color:#9ecbff"> MyRetryPolicy.yml</span></span>
<span class="line"><span style="color:#b392f0">â””â”€â”€</span><span style="color:#9ecbff"> pom.xml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#b392f0">27</span><span style="color:#9ecbff"> directories,</span><span style="color:#79b8ff"> 18</span><span style="color:#9ecbff"> files</span></span></code></pre></div><div class="mx-auto sm:px-6 max-w-3xl px-6 mt-8 flex flex-col justify-between sm:flex-row"><ul class="mr-5 rtl:ml-5 rtl:mr-0"><li class="mb-2 font-medium bg-gray-100 dark:bg-slate-700 inline-block lowercase mr-2 px-2 py-0.5 rtl:ml-2 rtl:mr-0"><a class="text-muted hover:text-primary dark:hover:text-gray-200 dark:text-slate-300" href="/tag/java">Java</a></li><li class="mb-2 font-medium bg-gray-100 dark:bg-slate-700 inline-block lowercase mr-2 px-2 py-0.5 rtl:ml-2 rtl:mr-0"><a class="text-muted hover:text-primary dark:hover:text-gray-200 dark:text-slate-300" href="/tag/java-pos">Java Pos</a></li><li class="mb-2 font-medium bg-gray-100 dark:bg-slate-700 inline-block lowercase mr-2 px-2 py-0.5 rtl:ml-2 rtl:mr-0"><a class="text-muted hover:text-primary dark:hover:text-gray-200 dark:text-slate-300" href="/tag/architecture">Architecture</a></li></ul><div class="align-middle dark:text-slate-600 mt-5 sm:mt-1 text-gray-500"><span class="font-bold align-super dark:text-slate-400 text-slate-500">Share:</span> <button class="rtl:ml-0 ml-2 rtl:mr-2" data-aw-social-share="twitter" data-aw-url="https://astrowind.vercel.app/ja/2025-06-23-pos-sample" title="Twitter Share" data-aw-text="Jpos-glue"><svg class="w-6 h-6 dark:hover:text-slate-300 dark:text-slate-500 hover:text-black text-gray-400" data-icon="tabler:brand-x" height="1em" width="1em" viewBox="0 0 24 24"><use href="#ai:tabler:brand-x"></use></svg></button> <button class="rtl:ml-0 ml-2 rtl:mr-2" data-aw-social-share="facebook" data-aw-url="https://astrowind.vercel.app/ja/2025-06-23-pos-sample" title="Facebook Share"><svg class="w-6 h-6 dark:hover:text-slate-300 dark:text-slate-500 hover:text-black text-gray-400" data-icon="tabler:brand-facebook" height="1em" width="1em" viewBox="0 0 24 24"><use href="#ai:tabler:brand-facebook"></use></svg></button> <button class="rtl:ml-0 ml-2 rtl:mr-2" data-aw-social-share="linkedin" data-aw-url="https://astrowind.vercel.app/ja/2025-06-23-pos-sample" title="Linkedin Share" data-aw-text="Jpos-glue"><svg class="w-6 h-6 dark:hover:text-slate-300 dark:text-slate-500 hover:text-black text-gray-400" data-icon="tabler:brand-linkedin" height="1em" width="1em"><symbol id="ai:tabler:brand-linkedin" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M8 11v5m0-8v.01M12 16v-5m4 5v-3a2 2 0 1 0-4 0"/><path d="M3 7a4 4 0 0 1 4-4h10a4 4 0 0 1 4 4v10a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4z"/></g></symbol><use href="#ai:tabler:brand-linkedin"></use></svg></button> <button class="rtl:ml-0 ml-2 rtl:mr-2" data-aw-social-share="whatsapp" data-aw-url="https://astrowind.vercel.app/ja/2025-06-23-pos-sample" title="Whatsapp Share" data-aw-text="Jpos-glue"><svg class="w-6 h-6 dark:hover:text-slate-300 dark:text-slate-500 hover:text-black text-gray-400" data-icon="tabler:brand-whatsapp" height="1em" width="1em"><symbol id="ai:tabler:brand-whatsapp" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="m3 21l1.65-3.8a9 9 0 1 1 3.4 2.9z"/><path d="M9 10a.5.5 0 0 0 1 0V9a.5.5 0 0 0-1 0za5 5 0 0 0 5 5h1a.5.5 0 0 0 0-1h-1a.5.5 0 0 0 0 1"/></g></symbol><use href="#ai:tabler:brand-whatsapp"></use></svg></button> <button class="rtl:ml-0 ml-2 rtl:mr-2" data-aw-social-share="mail" data-aw-url="https://astrowind.vercel.app/ja/2025-06-23-pos-sample" title="Email Share" data-aw-text="Jpos-glue"><svg class="w-6 h-6 dark:hover:text-slate-300 dark:text-slate-500 hover:text-black text-gray-400" data-icon="tabler:mail" height="1em" width="1em"><symbol id="ai:tabler:mail" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M3 7a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><path d="m3 7l9 6l9-6"/></g></symbol><use href="#ai:tabler:mail"></use></svg></button></div></div></article></section><div class="mx-auto sm:px-6 max-w-3xl px-6 md:pb-20 md:pt-4 pb-12 pt-8"><a class="btn btn-tertiary md:px-3 px-3" href="/blog"><svg class="h-5 w-5 -ml-1.5 mr-1 rtl:-mr-1.5 rtl:ml-1" data-icon="tabler:chevron-left" height="1em" width="1em"><symbol id="ai:tabler:chevron-left" viewBox="0 0 24 24"><path d="m15 6l-6 6l6 6" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/></symbol><use href="#ai:tabler:chevron-left"></use></svg> Back to Blog</a></div><section class="relative not-prose scroll-mt-[72px]"><div class="absolute inset-0 pointer-events-none -z-[1]" aria-hidden="true"><div class="absolute inset-0"></div></div><div class="mx-auto px-4 intersect-once intersect-once intersect-quarter intersect-quarter motion-safe:md:intersect:animate-fade motion-safe:md:intersect:animate-fade intercept-no-queue max-w-7xl motion-safe:md:opacity-0 relative lg:pt-0 lg:py-20 md:pt-0 md:px-6 md:py-16 pt-0 py-12 text-default"><div class="lg:flex-row flex flex-col lg:justify-between mb-8"><div class="md:max-w-sm"><h2 class="mb-2 font-bold font-heading group sm:leading-none sm:text-4xl text-3xl tracking-tight">Related Posts</h2><a class="text-muted dark:text-slate-400 block duration-200 ease-in hover:text-primary lg:mb-0 mb-6 transition" href="/blog">View All Posts Â»</a></div></div><div class="grid -mb-6 gap-6 lg:grid-cols-4 md:grid-cols-2 row-gap-5"><article class="transition mb-6 intersect-once intersect-quarter motion-safe:md:intersect:animate-fade motion-safe:md:opacity-0"><div class="relative bg-gray-400 dark:bg-slate-700 mb-6 md:h-64 rounded shadow-lg"></div><h3 class="mb-2 font-bold font-heading dark:text-slate-300 leading-tight sm:text-2xl text-xl"><a class="transition duration-200 ease-in hover:text-primary dark:hover:text-blue-700 inline-block" href="/en/2025-06-23-pos-sample">Jpos-glue</a></h3><p class="text-muted dark:text-slate-400 text-lg"></p></article><article class="transition mb-6 intersect-once intersect-quarter motion-safe:md:intersect:animate-fade motion-safe:md:opacity-0"><div class="relative bg-gray-400 dark:bg-slate-700 mb-6 md:h-64 rounded shadow-lg"></div><h3 class="mb-2 font-bold font-heading dark:text-slate-300 leading-tight sm:text-2xl text-xl"><a class="transition duration-200 ease-in hover:text-primary dark:hover:text-blue-700 inline-block" href="/zh/2025-06-23-pos-sample">Jpos-glue</a></h3><p class="text-muted dark:text-slate-400 text-lg"></p></article><article class="transition mb-6 intersect-once intersect-quarter motion-safe:md:intersect:animate-fade motion-safe:md:opacity-0"><div class="relative bg-gray-400 dark:bg-slate-700 mb-6 md:h-64 rounded shadow-lg"></div><h3 class="mb-2 font-bold font-heading dark:text-slate-300 leading-tight sm:text-2xl text-xl"><a class="transition duration-200 ease-in hover:text-primary dark:hover:text-blue-700 inline-block" href="/en/2025-06-13-unifiedpos-architecture">UnifiedPOS æž¶æž„ç®€ä»‹</a></h3><p class="text-muted dark:text-slate-400 text-lg"></p></article><article class="transition mb-6 intersect-once intersect-quarter motion-safe:md:intersect:animate-fade motion-safe:md:opacity-0"><div class="relative bg-gray-400 dark:bg-slate-700 mb-6 md:h-64 rounded shadow-lg"></div><h3 class="mb-2 font-bold font-heading dark:text-slate-300 leading-tight sm:text-2xl text-xl"><a class="transition duration-200 ease-in hover:text-primary dark:hover:text-blue-700 inline-block" href="/zh/2025-06-13-unifiedpos-architecture">UnifiedPOS æž¶æž„ç®€ä»‹</a></h3><p class="text-muted dark:text-slate-400 text-lg"></p></article></div></div></section></main><footer class="relative dark:border-slate-800 border-gray-200 border-t not-prose"><div class="absolute inset-0 pointer-events-none dark:bg-dark" aria-hidden="true"></div><div class="mx-auto sm:px-6 px-4 dark:text-slate-300 intercept-no-queue intersect-once intersect-quarter max-w-7xl motion-safe:md:intersect:animate-fade motion-safe:md:opacity-0 relative"><div class="grid gap-4 gap-y-8 grid-cols-12 md:py-12 py-8 sm:gap-8"><div class="col-span-12 lg:col-span-4"><div class="mb-2"><a class="inline-block font-bold text-xl" href="/">AstroWind</a></div><div class="text-muted text-sm gap-1 flex"><a class="text-muted dark:text-gray-400 duration-150 ease-in-out hover:text-gray-700 hover:underline transition" href="/terms">Terms</a> Â· <a class="text-muted dark:text-gray-400 duration-150 ease-in-out hover:text-gray-700 hover:underline transition" href="/privacy">Privacy Policy</a></div></div><div class="col-span-6 lg:col-span-2 md:col-span-3"><div class="mb-2 font-medium dark:text-gray-300">Product</div><ul class="text-sm"><li class="mb-2"><a class="text-muted dark:text-gray-400 duration-150 ease-in-out hover:text-gray-700 hover:underline transition" href="#">Features</a></li><li class="mb-2"><a class="text-muted dark:text-gray-400 duration-150 ease-in-out hover:text-gray-700 hover:underline transition" href="#">Security</a></li><li class="mb-2"><a class="text-muted dark:text-gray-400 duration-150 ease-in-out hover:text-gray-700 hover:underline transition" href="#">Team</a></li><li class="mb-2"><a class="text-muted dark:text-gray-400 duration-150 ease-in-out hover:text-gray-700 hover:underline transition" href="#">Enterprise</a></li><li class="mb-2"><a class="text-muted dark:text-gray-400 duration-150 ease-in-out hover:text-gray-700 hover:underline transition" href="#">Customer stories</a></li><li class="mb-2"><a class="text-muted dark:text-gray-400 duration-150 ease-in-out hover:text-gray-700 hover:underline transition" href="#">Pricing</a></li><li class="mb-2"><a class="text-muted dark:text-gray-400 duration-150 ease-in-out hover:text-gray-700 hover:underline transition" href="#">Resources</a></li></ul></div><div class="col-span-6 lg:col-span-2 md:col-span-3"><div class="mb-2 font-medium dark:text-gray-300">Platform</div><ul class="text-sm"><li class="mb-2"><a class="text-muted dark:text-gray-400 duration-150 ease-in-out hover:text-gray-700 hover:underline transition" href="#">Developer API</a></li><li class="mb-2"><a class="text-muted dark:text-gray-400 duration-150 ease-in-out hover:text-gray-700 hover:underline transition" href="#">Partners</a></li><li class="mb-2"><a class="text-muted dark:text-gray-400 duration-150 ease-in-out hover:text-gray-700 hover:underline transition" href="#">Atom</a></li><li class="mb-2"><a class="text-muted dark:text-gray-400 duration-150 ease-in-out hover:text-gray-700 hover:underline transition" href="#">Electron</a></li><li class="mb-2"><a class="text-muted dark:text-gray-400 duration-150 ease-in-out hover:text-gray-700 hover:underline transition" href="#">AstroWind Desktop</a></li></ul></div><div class="col-span-6 lg:col-span-2 md:col-span-3"><div class="mb-2 font-medium dark:text-gray-300">Support</div><ul class="text-sm"><li class="mb-2"><a class="text-muted dark:text-gray-400 duration-150 ease-in-out hover:text-gray-700 hover:underline transition" href="#">Docs</a></li><li class="mb-2"><a class="text-muted dark:text-gray-400 duration-150 ease-in-out hover:text-gray-700 hover:underline transition" href="#">Community Forum</a></li><li class="mb-2"><a class="text-muted dark:text-gray-400 duration-150 ease-in-out hover:text-gray-700 hover:underline transition" href="#">Professional Services</a></li><li class="mb-2"><a class="text-muted dark:text-gray-400 duration-150 ease-in-out hover:text-gray-700 hover:underline transition" href="#">Skills</a></li><li class="mb-2"><a class="text-muted dark:text-gray-400 duration-150 ease-in-out hover:text-gray-700 hover:underline transition" href="#">Status</a></li></ul></div><div class="col-span-6 lg:col-span-2 md:col-span-3"><div class="mb-2 font-medium dark:text-gray-300">Company</div><ul class="text-sm"><li class="mb-2"><a class="text-muted dark:text-gray-400 duration-150 ease-in-out hover:text-gray-700 hover:underline transition" href="#">About</a></li><li class="mb-2"><a class="text-muted dark:text-gray-400 duration-150 ease-in-out hover:text-gray-700 hover:underline transition" href="#">Blog</a></li><li class="mb-2"><a class="text-muted dark:text-gray-400 duration-150 ease-in-out hover:text-gray-700 hover:underline transition" href="#">Careers</a></li><li class="mb-2"><a class="text-muted dark:text-gray-400 duration-150 ease-in-out hover:text-gray-700 hover:underline transition" href="#">Press</a></li><li class="mb-2"><a class="text-muted dark:text-gray-400 duration-150 ease-in-out hover:text-gray-700 hover:underline transition" href="#">Inclusion</a></li><li class="mb-2"><a class="text-muted dark:text-gray-400 duration-150 ease-in-out hover:text-gray-700 hover:underline transition" href="#">Social Impact</a></li><li class="mb-2"><a class="text-muted dark:text-gray-400 duration-150 ease-in-out hover:text-gray-700 hover:underline transition" href="#">Shop</a></li></ul></div></div><div class="md:justify-between md:flex md:items-center md:py-8 py-6"><ul class="rtl:ml-0 -ml-2 flex mb-4 md:mb-0 md:ml-4 md:order-1 rtl:-mr-2 rtl:md:ml-0 rtl:md:mr-4"><li><a class="text-muted dark:text-gray-400 dark:focus:ring-gray-700 dark:hover:bg-gray-700 focus:outline-none focus:ring-4 focus:ring-gray-200 hover:bg-gray-100 inline-flex items-center p-2.5 rounded-lg text-sm" href="#" aria-label="X"><svg class="h-5 w-5" data-icon="tabler:brand-x" height="1em" width="1em"><symbol id="ai:tabler:brand-x" viewBox="0 0 24 24"><path d="m4 4l11.733 16H20L8.267 4zm0 16l6.768-6.768m2.46-2.46L20 4" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/></symbol><use href="#ai:tabler:brand-x"></use></svg></a></li><li><a class="text-muted dark:text-gray-400 dark:focus:ring-gray-700 dark:hover:bg-gray-700 focus:outline-none focus:ring-4 focus:ring-gray-200 hover:bg-gray-100 inline-flex items-center p-2.5 rounded-lg text-sm" href="#" aria-label="Instagram"><svg class="h-5 w-5" data-icon="tabler:brand-instagram" height="1em" width="1em"><symbol id="ai:tabler:brand-instagram" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M4 8a4 4 0 0 1 4-4h8a4 4 0 0 1 4 4v8a4 4 0 0 1-4 4H8a4 4 0 0 1-4-4z"/><path d="M9 12a3 3 0 1 0 6 0a3 3 0 0 0-6 0m7.5-4.5v.01"/></g></symbol><use href="#ai:tabler:brand-instagram"></use></svg></a></li><li><a class="text-muted dark:text-gray-400 dark:focus:ring-gray-700 dark:hover:bg-gray-700 focus:outline-none focus:ring-4 focus:ring-gray-200 hover:bg-gray-100 inline-flex items-center p-2.5 rounded-lg text-sm" href="#" aria-label="Facebook"><svg class="h-5 w-5" data-icon="tabler:brand-facebook" height="1em" width="1em"><symbol id="ai:tabler:brand-facebook" viewBox="0 0 24 24"><path d="M7 10v4h3v7h4v-7h3l1-4h-4V8a1 1 0 0 1 1-1h3V3h-3a5 5 0 0 0-5 5v2z" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/></symbol><use href="#ai:tabler:brand-facebook"></use></svg></a></li><li><a class="text-muted dark:text-gray-400 dark:focus:ring-gray-700 dark:hover:bg-gray-700 focus:outline-none focus:ring-4 focus:ring-gray-200 hover:bg-gray-100 inline-flex items-center p-2.5 rounded-lg text-sm" href="/rss.xml" aria-label="RSS"><svg class="h-5 w-5" data-icon="tabler:rss" height="1em" width="1em" viewBox="0 0 24 24"><use href="#ai:tabler:rss"></use></svg></a></li><li><a class="text-muted dark:text-gray-400 dark:focus:ring-gray-700 dark:hover:bg-gray-700 focus:outline-none focus:ring-4 focus:ring-gray-200 hover:bg-gray-100 inline-flex items-center p-2.5 rounded-lg text-sm" href="https://github.com/onwidget/astrowind" aria-label="Github"><svg class="h-5 w-5" data-icon="tabler:brand-github" height="1em" width="1em"><symbol id="ai:tabler:brand-github" viewBox="0 0 24 24"><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2c2.8-.3 5.5-1.4 5.5-6a4.6 4.6 0 0 0-1.3-3.2a4.2 4.2 0 0 0-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3 0 0 0-6.2 0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2 0 0 0-.1 3.2A4.6 4.6 0 0 0 4 9.5c0 4.6 2.7 5.7 5.5 6c-.6.6-.6 1.2-.5 2V21" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/></symbol><use href="#ai:tabler:brand-github"></use></svg></a></li></ul><div class="dark:text-muted mr-4 text-sm"><img alt="onWidget logo" class="h-5 w-5 bg-cover float-left md:-mt-0.5 md:h-6 md:w-6 mr-1.5 rounded-sm rtl:float-right rtl:ml-1.5 rtl:mr-0" loading="lazy" src="https://onwidget.com/favicon/favicon-32x32.png">Made by <a class="dark:text-muted text-blue-600 underline" href="https://onwidget.com/">onWidget</a> Â· All rights reserved.</div></div></div></footer><script>!function(){const e="system";if(window.basic_script)return;function t(e){"dark"===e?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")}window.basic_script=!0;const d=function(){e&&e.endsWith(":only")||(localStorage.theme,0)?t(e.replace(":only","")):"dark"===localStorage.theme||!("theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):t("light")};function a(e,t,d){const a="string"==typeof e?document.querySelectorAll(e):e;a&&a.length&&a.forEach((e=>{e.addEventListener(t,(t=>d(t,e)),!1)}))}d();const o=function(){let t=window.scrollY,d=!0;a("#header nav","click",(function(){document.querySelector("[data-aw-toggle-menu]")?.classList.remove("expanded"),document.body.classList.remove("overflow-hidden"),document.getElementById("header")?.classList.remove("h-screen"),document.getElementById("header")?.classList.remove("expanded"),document.getElementById("header")?.classList.remove("bg-page"),document.querySelector("#header nav")?.classList.add("hidden"),document.querySelector("#header > div > div:last-child")?.classList.add("hidden")})),a("[data-aw-toggle-menu]","click",(function(e,t){t.classList.toggle("expanded"),document.body.classList.toggle("overflow-hidden"),document.getElementById("header")?.classList.toggle("h-screen"),document.getElementById("header")?.classList.toggle("expanded"),document.getElementById("header")?.classList.toggle("bg-page"),document.querySelector("#header nav")?.classList.toggle("hidden"),document.querySelector("#header > div > div:last-child")?.classList.toggle("hidden")})),a("[data-aw-toggle-color-scheme]","click",(function(){e.endsWith(":only")||(document.documentElement.classList.toggle("dark"),localStorage.theme=document.documentElement.classList.contains("dark")?"dark":"light")})),a("[data-aw-social-share]","click",(function(e,t){const d=t.getAttribute("data-aw-social-share"),a=encodeURIComponent(t.getAttribute("data-aw-url")),o=encodeURIComponent(t.getAttribute("data-aw-text"));let n;switch(d){case"facebook":n=`https://www.facebook.com/sharer.php?u=${a}`;break;case"twitter":n=`https://twitter.com/intent/tweet?url=${a}&text=${o}`;break;case"linkedin":n=`https://www.linkedin.com/shareArticle?mini=true&url=${a}&title=${o}`;break;case"whatsapp":n=`https://wa.me/?text=${o}%20${a}`;break;case"mail":n=`mailto:?subject=%22${o}%22&body=${o}%20${a}`;break;default:return}const c=document.createElement("a");c.target="_blank",c.href=n,c.click()}));function o(){const e=document.querySelector("#header[data-aw-sticky-header]");e&&(t>60&&!e.classList.contains("scroll")?e.classList.add("scroll"):t<=60&&e.classList.contains("scroll")&&e.classList.remove("scroll"),d=!1)}window.matchMedia("(max-width: 767px)").addEventListener("change",(function(){document.querySelector("[data-aw-toggle-menu]")?.classList.remove("expanded"),document.body.classList.remove("overflow-hidden"),document.getElementById("header")?.classList.remove("h-screen"),document.getElementById("header")?.classList.remove("expanded"),document.getElementById("header")?.classList.remove("bg-page"),document.querySelector("#header nav")?.classList.add("hidden"),document.querySelector("#header > div > div:last-child")?.classList.add("hidden")})),o(),a([document],"scroll",(function(){t=window.scrollY,d||(window.requestAnimationFrame((()=>{o()})),d=!0)}))},n=function(){document.documentElement.classList.add("motion-safe:scroll-smooth");const e=document.querySelector("[data-aw-toggle-menu]");e&&e.classList.remove("expanded"),document.body.classList.remove("overflow-hidden"),document.getElementById("header")?.classList.remove("h-screen"),document.getElementById("header")?.classList.remove("expanded"),document.querySelector("#header nav")?.classList.add("hidden")};window.onload=o,window.onpageshow=n,document.addEventListener("astro:after-swap",(()=>{d(),o(),n()}))}()</script><script>const Observer={observer:null,delayBetweenAnimations:100,animationCounter:0,start(){const t=Array.from(document.querySelectorAll(['[class*=" intersect:"]','[class*=":intersect:"]','[class^="intersect:"]','[class="intersect"]','[class*=" intersect "]','[class^="intersect "]','[class$=" intersect"]'].join(",")));t.forEach((t=>{var e;t.setAttribute("no-intersect",""),t._intersectionThreshold=(e=t).classList.contains("intersect-full")?.99:e.classList.contains("intersect-half")?.5:e.classList.contains("intersect-quarter")?.25:0}));this.observer=new IntersectionObserver((t=>{t.forEach((t=>{requestAnimationFrame((()=>{const e=t.target,s=t.intersectionRatio,n=e._intersectionThreshold;if(e.classList.contains("intersect-no-queue"))t.isIntersecting?(e.removeAttribute("no-intersect"),e.classList.contains("intersect-once")&&this.observer.unobserve(e)):e.setAttribute("no-intersect","");else if(s>=n){if(!e.hasAttribute("data-animated")){e.removeAttribute("no-intersect"),e.setAttribute("data-animated","true");const t=this.animationCounter*this.delayBetweenAnimations;this.animationCounter++,e.style.transitionDelay=`${t}ms`,e.style.animationDelay=`${t}ms`,e.classList.contains("intersect-once")&&this.observer.unobserve(e)}}else e.setAttribute("no-intersect",""),e.removeAttribute("data-animated"),e.style.transitionDelay="",e.style.animationDelay="",this.animationCounter=0}))}))}).bind(this),{threshold:[0,.25,.5,.99]}),t.forEach((t=>{this.observer.observe(t)}))}};Observer.start(),document.addEventListener("astro:after-swap",(()=>{Observer.start()}))</script></body></html>